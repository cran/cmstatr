<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Stefan Kloppenborg" />

<meta name="date" content="2024-03-14" />

<title>cmstatr Validation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">cmstatr Validation</h1>
<h4 class="author">Stefan Kloppenborg</h4>
<h4 class="date">2024-03-14</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">1.
Introduction</a></li>
<li><a href="#validation-table" id="toc-validation-table">2. Validation
Table</a></li>
<li><a href="#carbon.fabric-data-set" id="toc-carbon.fabric-data-set">3.
<code>carbon.fabric</code> Data Set</a>
<ul>
<li><a href="#cf-ad" id="toc-cf-ad">3.1. Anderson–Darling k-Sample
Test</a></li>
</ul></li>
<li><a href="#comparison-with-examples-from-cmh-17-1g" id="toc-comparison-with-examples-from-cmh-17-1g">4. Comparison with
Examples from CMH-17-1G</a>
<ul>
<li><a href="#dataset-from-section-8.3.11.1.1" id="toc-dataset-from-section-8.3.11.1.1">4.1 Dataset From Section
8.3.11.1.1</a></li>
<li><a href="#dataset-from-section-8.3.11.1.2" id="toc-dataset-from-section-8.3.11.1.2">4.2 Dataset From Section
8.3.11.1.2</a></li>
</ul></li>
<li><a href="#other-data-sets" id="toc-other-data-sets">5. Other Data
Sets</a>
<ul>
<li><a href="#ods-adn" id="toc-ods-adn">5.1 Anderson–Darling Test
(Normal)</a></li>
<li><a href="#ods-adl" id="toc-ods-adl">5.2 Anderson–Darling Test
(Lognormal)</a></li>
<li><a href="#ods-adw" id="toc-ods-adw">5.3 Anderson–Darling Test
(Weibull)</a></li>
<li><a href="#ods-nb" id="toc-ods-nb">5.4 Normal A- and B-Basis</a></li>
<li><a href="#ods-lb" id="toc-ods-lb">5.5 Lognormal A- and
B-Basis</a></li>
<li><a href="#ods-wb" id="toc-ods-wb">5.6 Weibull A- and
B-Basis</a></li>
<li><a href="#ods-hkb" id="toc-ods-hkb">5.7 Extended Hanson–Koopmans A-
and B-Basis</a></li>
<li><a href="#ods-hkb2" id="toc-ods-hkb2">5.8 Extended Hanson–Koopmans
B-Basis</a></li>
<li><a href="#ods-lsnb" id="toc-ods-lsnb">5.9 Large Sample Nonparametric
B-Basis</a></li>
<li><a href="#ods-eme" id="toc-ods-eme">5.10 Acceptance Limits Based on
Mean and Extremum</a></li>
<li><a href="#ods-ecm" id="toc-ods-ecm">5.11 Acceptance Based on Change
in Mean</a></li>
</ul></li>
<li><a href="#comparison-with-literature" id="toc-comparison-with-literature">6. Comparison with Literature</a>
<ul>
<li><a href="#cl-adk" id="toc-cl-adk">6.1 Anderson–Darling K–Sample
Test</a></li>
</ul></li>
<li><a href="#comparison-with-published-factors" id="toc-comparison-with-published-factors">7. Comparison with Published
Factors</a>
<ul>
<li><a href="#pf-kb" id="toc-pf-kb">7.1 Normal kB Factors</a></li>
<li><a href="#pf-ka" id="toc-pf-ka">7.2 Normal kA Factors</a></li>
<li><a href="#pf-hk" id="toc-pf-hk">7.3 Nonparametric B-Basis Extended
Hanson–Koopmans</a></li>
<li><a href="#pf-hk2" id="toc-pf-hk2">7.4 Nonparametric A-Basis Extended
Hanson–Koopmans</a></li>
<li><a href="#pf-hk-opt" id="toc-pf-hk-opt">7.5 Factors for Small Sample
Nonparametric B-Basis</a></li>
<li><a href="#pf-npbinom" id="toc-pf-npbinom">7.6 Nonparametric B-Basis
Binomial Rank</a></li>
<li><a href="#pf-npbinom2" id="toc-pf-npbinom2">7.7 Nonparametric
A-Basis Binomial Rank</a></li>
<li><a href="#pf-equiv" id="toc-pf-equiv">7.8 Factors for
Equivalency</a></li>
</ul></li>
<li><a href="#session-info" id="toc-session-info">8. Session
Info</a></li>
<li><a href="#references" id="toc-references">9. References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>This vignette is intended to contain the same validation that is
included in the test suite within the <code>cmstatr</code> package, but
in a format that is easier for a human to read. The intent is that this
vignette will include only those validations that are included in the
test suite, but that the test suite may include more tests than are
shown in this vignette.</p>
<p>The following packages will be used in this validation. The version
of each package used is listed at the end of this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(cmstatr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(testthat)</span></code></pre></div>
<p>Throughout this vignette, the <code>testthat</code> package will be
used. Expressions such as <code>expect_equal</code> are used to ensure
that the two values are equal (within some tolerance). If this
expectation is not true, the vignette will fail to build. The tolerance
is a relative tolerance: a tolerance of 0.01 means that the two values
must be within <span class="math inline">\(1\%\)</span> of each other.
As an example, the following expression checks that the value
<code>10</code> is equal to <code>10.1</code> within a tolerance of
<code>0.01</code>. Such an expectation should be satisfied.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">expect_equal</span>(<span class="dv">10</span>, <span class="fl">10.1</span>, <span class="at">tolerance =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p>The <code>basis_...</code> functions automatically perform certain
diagnostic tests. When those diagnostic tests are not relevant to the
validation, the diagnostic tests are overridden by passing the argument
<code>override = &quot;all&quot;</code>.</p>
</div>
<div id="validation-table" class="section level1">
<h1>2. Validation Table</h1>
<p>The following table provides a cross-reference between the various
functions of the <code>cmstatr</code> package and the tests shown within
this vignette. The sections in this vignette are organized by data set.
Not all checks are performed on all data sets.</p>
<table>
<colgroup>
<col width="54%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Tests</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ad_ksample()</code></td>
<td><a href="#cf-ad">Section 3.1</a>, <a href="#c11-adk">Section
4.1.2</a>, <a href="#cl-adk">Section 6.1</a></td>
</tr>
<tr class="even">
<td><code>anderson_darling_normal()</code></td>
<td><a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adn">Section
5.1</a></td>
</tr>
<tr class="odd">
<td><code>anderson_darling_lognormal()</code></td>
<td><a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adl">Section
5.2</a></td>
</tr>
<tr class="even">
<td><code>anderson_darling_weibull()</code></td>
<td><a href="#c11-ad">Section 4.1.3</a>, <a href="#ods-adw">Section
5.3</a></td>
</tr>
<tr class="odd">
<td><code>basis_normal()</code></td>
<td><a href="#ods-nb">Section 5.4</a></td>
</tr>
<tr class="even">
<td><code>basis_lognormal()</code></td>
<td><a href="#ods-lb">Section 5.5</a></td>
</tr>
<tr class="odd">
<td><code>basis_weibull()</code></td>
<td><a href="#ods-wb">Section 5.6</a></td>
</tr>
<tr class="even">
<td><code>basis_pooled_cv()</code></td>
<td><a href="#c12-pcv">Section 4.2.3</a>, <a href="#c12-pcvmcv">Section
4.2.4</a>,</td>
</tr>
<tr class="odd">
<td><code>basis_pooled_sd()</code></td>
<td><a href="#c12-psd">Section 4.2.1</a>, <a href="#c12-psdmcv">Section
4.2.2</a></td>
</tr>
<tr class="even">
<td><code>basis_hk_ext()</code></td>
<td><a href="#c11-hk-wf">Section 4.1.6</a>, <a href="#ods-hkb">Section
5.7</a>, <a href="#ods-hkb2">Section 5.8</a></td>
</tr>
<tr class="odd">
<td><code>basis_nonpara_large_sample()</code></td>
<td><a href="#ods-lsnb">Section 5.9</a></td>
</tr>
<tr class="even">
<td><code>basis_anova()</code></td>
<td><a href="#c11-anova">Section 4.1.7</a></td>
</tr>
<tr class="odd">
<td><code>calc_cv_star()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>cv()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>equiv_change_mean()</code></td>
<td><a href="#ods-ecm">Section 5.11</a></td>
</tr>
<tr class="even">
<td><code>equiv_mean_extremum()</code></td>
<td><a href="#ods-eme">Section 5.10</a></td>
</tr>
<tr class="odd">
<td><code>hk_ext_z()</code></td>
<td><a href="#pf-hk">Section 7.3</a>, <a href="#pf-hk2">Section
7.4</a></td>
</tr>
<tr class="even">
<td><code>hk_ext_z_j_opt()</code></td>
<td><a href="#pf-hk-opt">Section 7.5</a></td>
</tr>
<tr class="odd">
<td><code>k_equiv()</code></td>
<td><a href="#pf-equiv">Section 7.8</a></td>
</tr>
<tr class="even">
<td><code>k_factor_normal()</code></td>
<td><a href="#pf-kb">Section 7.1</a>, <a href="#pf-ka">Section
7.2</a></td>
</tr>
<tr class="odd">
<td><code>levene_test()</code></td>
<td><a href="#c11-lbc">Section 4.1.4</a>, <a href="#c11-lbb">Section
4.1.5</a></td>
</tr>
<tr class="even">
<td><code>maximum_normed_residual()</code></td>
<td><a href="#c11-mnr">Section 4.1.1</a></td>
</tr>
<tr class="odd">
<td><code>nonpara_binomial_rank()</code></td>
<td><a href="#pf-npbinom">Section 7.6</a>, <a href="#pf-npbinom2">Section 7.7</a></td>
</tr>
<tr class="even">
<td><code>normalize_group_mean()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>normalize_ply_thickness()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>transform_mod_cv_ad()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>transform_mod_cv()</code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="carbon.fabric-data-set" class="section level1">
<h1>3. <code>carbon.fabric</code> Data Set</h1>
<p>This data set is example data that is provided with
<code>cmstatr</code>. The first few rows of this data are shown
below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">head</span>(carbon.fabric)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;           id test condition batch strength</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 1 WT-RTD-1-1   WT       RTD     1 137.4438</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 2 WT-RTD-1-2   WT       RTD     1 139.5395</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 3 WT-RTD-1-3   WT       RTD     1 150.8900</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 4 WT-RTD-1-4   WT       RTD     1 141.4474</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 5 WT-RTD-1-5   WT       RTD     1 141.8203</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 6 WT-RTD-1-6   WT       RTD     1 151.8821</span></span></code></pre></div>
<div id="cf-ad" class="section level2">
<h2>3.1. Anderson–Darling k-Sample Test</h2>
<p>This data was entered into ASAP 2008 <span class="citation">[1]</span> and the reported Anderson–Darling k–Sample
test statistics were recorded, as were the conclusions.</p>
<p>The value of the test statistic reported by <code>cmstatr</code> and
that reported by ASAP 2008 differ by a factor of <span class="math inline">\(k - 1\)</span>, as do the critical values used. As
such, the conclusion of the tests are identical. This is described in
more detail in the <a href="adktest.html">Anderson–Darling k–Sample
Vignette</a>.</p>
<p>When the RTD warp-tension data from this data set is entered into
ASAP 2008, it reports a test statistic of 0.456 and fails to reject the
null hypothesis that the batches are drawn from the same distribution.
Adjusting for the different definition of the test statistic, the
results given by <code>cmstatr</code> are very similar.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> carbon.fabric <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">filter</span>(test <span class="sc">==</span> <span class="st">&quot;WT&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">ad_ksample</span>(strength, batch)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>ad <span class="sc">/</span> (res<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>), <span class="fl">0.456</span>, <span class="at">tolerance =</span> <span class="fl">0.002</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">expect_false</span>(res<span class="sc">$</span>reject_same_dist)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>res</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; N = 18           k = 3            </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; ADK = 0.912      p-value = 0.95989 </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></span></code></pre></div>
<p>When the ETW warp-tension data from this data set are entered into
ASAP 2008, the reported test statistic is 1.604 and it fails to reject
the null hypothesis that the batches are drawn from the same
distribution. Adjusting for the different definition of the test
statistic, <code>cmstatr</code> gives nearly identical results.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> carbon.fabric <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">filter</span>(test <span class="sc">==</span> <span class="st">&quot;WT&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">ad_ksample</span>(strength, batch)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>ad <span class="sc">/</span> (res<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>), <span class="fl">1.604</span>, <span class="at">tolerance =</span> <span class="fl">0.002</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">expect_false</span>(res<span class="sc">$</span>reject_same_dist)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>res</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; N = 18           k = 3            </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; ADK = 3.21       p-value = 0.10208 </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></span></code></pre></div>
</div>
</div>
<div id="comparison-with-examples-from-cmh-17-1g" class="section level1">
<h1>4. Comparison with Examples from CMH-17-1G</h1>
<div id="dataset-from-section-8.3.11.1.1" class="section level2">
<h2>4.1 Dataset From Section 8.3.11.1.1</h2>
<p>CMH-17-1G <span class="citation">[2]</span> provides an example data
set and results from ASAP <span class="citation">[1]</span> and STAT17
<span class="citation">[3]</span>. This example data set is duplicated
below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>dat_8_3_11_1_1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="sc">~</span>batch, <span class="sc">~</span>strength, <span class="sc">~</span>condition,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">118.3774604</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">84.9581364</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">83.7436035</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">123.6035612</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">92.4891822</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">84.3831677</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">115.2238092</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">96.8212659</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">94.8030433</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">112.6379744</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">109.030325</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">94.3931537</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">116.5564277</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">97.8212659</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">101.702222</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">123.1649896</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">100.921519</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">86.5372121</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">128.5589027</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">103.699444</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">92.3772684</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">113.1462103</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">93.7908212</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">89.2084024</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">121.4248107</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">107.526709</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">100.686001</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">134.3241906</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">94.5769704</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">81.0444192</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">129.6405117</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">93.8831373</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">91.3398070</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">117.9818658</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">98.2296605</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">93.1441939</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">115.4505226</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">111.346590</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">85.8204168</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">120.0369467</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">100.817538</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">94.8966273</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">117.1631088</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">100.382203</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">95.8068520</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">112.9302797</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">91.5037811</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">86.7842252</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">117.9114501</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">100.083233</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">94.4011973</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">120.1900159</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">95.6393615</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">96.7231171</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">110.7295966</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">109.304779</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">89.9010384</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">100.078562</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">99.1205847</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">89.3672306</span>, <span class="st">&quot;ETD&quot;</span>,</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">106.357525</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">99.0239966</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">105.898733</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">103.341238</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">88.4640082</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">100.302130</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">103.901744</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">98.4634133</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">80.2058219</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">92.2647280</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">109.199597</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">103.487693</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">61.0139431</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">113.734763</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">99.3207107</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">108.172659</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">115.861770</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">108.426732</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">82.6133082</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">116.260375</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">85.3690411</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">121.049610</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">115.801622</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">111.223082</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">44.3217741</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">104.574843</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">117.328077</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">103.222552</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">88.6782903</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">99.3918538</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">107.676986</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">87.3421658</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">108.960241</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">102.730741</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">116.122640</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">96.3694916</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">80.2334815</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">99.5946088</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">106.145570</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">97.0712407</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">104.667866</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">104.234953</span>, <span class="st">&quot;ETW&quot;</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>)</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>dat_8_3_11_1_1</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; # A tibble: 102 × 3</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt;    batch strength condition</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    </span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt;  1     1    118.  CTD      </span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt;  2     1     85.0 RTD      </span></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a><span class="co">#&gt;  3     1     83.7 ETD      </span></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a><span class="co">#&gt;  4     1    124.  CTD      </span></span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#&gt;  5     1     92.5 RTD      </span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a><span class="co">#&gt;  6     1     84.4 ETD      </span></span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a><span class="co">#&gt;  7     1    115.  CTD      </span></span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a><span class="co">#&gt;  8     1     96.8 RTD      </span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a><span class="co">#&gt;  9     1     94.8 ETD      </span></span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a><span class="co">#&gt; 10     1    113.  CTD      </span></span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a><span class="co">#&gt; # ℹ 92 more rows</span></span></code></pre></div>
<div id="c11-mnr" class="section level3">
<h3>4.1.1 Maximum Normed Residual Test</h3>
<p>CMH-17-1G Table 8.3.11.1.1(a) provides results of the MNR test from
ASAP for this data set. Batches 2 and 3 of the ETW data is considered
here and the results of <code>cmstatr</code> are compared with those
published in CMH-17-1G.</p>
<p>For Batch 2 of the ETW data, the results match those published in the
handbook within a small tolerance. The published test statistic is
2.008.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span> <span class="sc">&amp;</span> batch <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">maximum_normed_residual</span>(strength, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>mnr, <span class="fl">2.008</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>crit, <span class="fl">2.127</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>n_outliers, <span class="dv">0</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>res</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; maximum_normed_residual(data = ., x = strength, alpha = 0.05)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; MNR = 2.008274  ( critical value = 2.126645 )</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; No outliers detected ( alpha = 0.05 )</span></span></code></pre></div>
<p>Similarly, for Batch 3 of the ETW data, the results of
<code>cmstatr</code> match the results published in the handbook within
a small tolerance. The published test statistic is 2.119</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span> <span class="sc">&amp;</span> batch <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">maximum_normed_residual</span>(strength, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>mnr, <span class="fl">2.119</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>crit, <span class="fl">2.020</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>n_outliers, <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>res</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; maximum_normed_residual(data = ., x = strength, alpha = 0.05)</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; MNR = 2.119175  ( critical value = 2.019969 )</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; Outliers ( alpha = 0.05 ):</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;    Index    Value            </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;        4    80.23348</span></span></code></pre></div>
</div>
<div id="c11-adk" class="section level3">
<h3>4.1.2 Anderson–Darling k–Sample Test</h3>
<p>For the ETW condition, the ADK test statistic given in <span class="citation">[2]</span> is <span class="math inline">\(ADK =
0.793\)</span> and the test concludes that the samples come from the
same distribution. Noting that <code>cmstatr</code> uses the definition
of the test statistic given in <span class="citation">[4]</span>, so the
test statistic given by <code>cmstatr</code> differs from that given by
ASAP by a factor of <span class="math inline">\(k - 1\)</span>, as
described in the <a href="adktest.html">Anderson–Darling k–Sample
Vignette</a>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">ad_ksample</span>(strength, batch)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>ad <span class="sc">/</span> (res<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>), <span class="fl">0.793</span>, <span class="at">tolerance =</span> <span class="fl">0.003</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">expect_false</span>(res<span class="sc">$</span>reject_same_dist)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>res</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; N = 22           k = 3            </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; ADK = 1.59       p-value = 0.59491 </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples come from the same distribution ( alpha = 0.025 )</span></span></code></pre></div>
<p>Similarly, for the ETW2 condition, the test statistic given in <span class="citation">[2]</span> is <span class="math inline">\(ADK =
3.024\)</span> and the test concludes that the samples come from
different distributions. This matches <code>cmstatr</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">ad_ksample</span>(strength, batch)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>ad <span class="sc">/</span> (res<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>), <span class="fl">3.024</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">expect_true</span>(res<span class="sc">$</span>reject_same_dist)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>res</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; ad_ksample(data = ., x = strength, groups = batch)</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; N = 20           k = 3            </span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; ADK = 6.05       p-value = 0.0042703 </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples do not come from the same distribution (alpha = 0.025 )</span></span></code></pre></div>
</div>
<div id="c11-ad" class="section level3">
<h3>4.1.3 Anderson–Darling Tests for Distribution</h3>
<p>CMH-17-1G Section 8.3.11.2.1 contains results from STAT17 for the
“observed significance level” from the Anderson–Darling test for various
distributions. In this section, the ETW condition from the present data
set is used. The published results are given in the following table. The
results from <code>cmstatr</code> are below and are very similar to
those from STAT17.</p>
<table>
<thead>
<tr class="header">
<th>Distribution</th>
<th>OSL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Normal</td>
<td>0.006051</td>
</tr>
<tr class="even">
<td>Lognormal</td>
<td>0.000307</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td>0.219</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">anderson_darling_normal</span>(strength)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.006051</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>res</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; anderson_darling_normal(data = ., x = strength)</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal ( n = 22 ) </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 1.052184 </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.006051441  (assuming unknown parameters)</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is not drawn from a Normal distribution ( alpha = 0.05 )</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">anderson_darling_lognormal</span>(strength)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.000307</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>res</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; anderson_darling_lognormal(data = ., x = strength)</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Lognormal ( n = 22 ) </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 1.568825 </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.0003073592  (assuming unknown parameters)</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is not drawn from a Lognormal distribution ( alpha = 0.05 )</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">anderson_darling_weibull</span>(strength)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.0219</span>, <span class="at">tolerance =</span> <span class="fl">0.002</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>res</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; anderson_darling_weibull(data = ., x = strength)</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Weibull ( n = 22 ) </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 0.8630665 </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.02186889  (assuming unknown parameters)</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is not drawn from a Weibull distribution ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="c11-lbc" class="section level3">
<h3>4.1.4 Levene’s Test (Between Conditions)</h3>
<p>CMH-17-1G Section 8.3.11.1.1 provides results from ASAP for Levene’s
test for equality of variance between conditions after the ETW and ETW2
conditions are removed. The handbook shows an F statistic of 0.58,
however if this data is entered into ASAP directly, ASAP gives an F
statistic of 0.058, which matches the result of
<code>cmstatr</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">!=</span> <span class="st">&quot;ETW&quot;</span> <span class="sc">&amp;</span> condition <span class="sc">!=</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">levene_test</span>(strength, condition)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>f, <span class="fl">0.058</span>, <span class="at">tolerance =</span> <span class="fl">0.01</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>res</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; levene_test(data = ., x = strength, groups = condition)</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; n = 60           k = 3            </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; F = 0.05811631   p-value = 0.943596 </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples have equal variances ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="c11-lbb" class="section level3">
<h3>4.1.5 Levene’s Test (Between Batches)</h3>
<p>CMH-17-1G Section 8.3.11.2.2 provides output from STAT17. The ETW2
condition from the present data set was analyzed by STAT17 and that
software reported an F statistic of 0.123 from Levene’s test when
comparing the variance of the batches within this condition. The result
from <code>cmstatr</code> is similar.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">levene_test</span>(strength, batch)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>f, <span class="fl">0.123</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>res</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; levene_test(data = ., x = strength, groups = batch)</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; n = 20           k = 3            </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; F = 0.1233937    p-value = 0.8847 </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples have equal variances ( alpha = 0.05 )</span></span></code></pre></div>
<p>Similarly, the published value of the F statistic for the CTD
condition is <span class="math inline">\(3.850\)</span>.
<code>cmstatr</code> produces very similar results.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">levene_test</span>(strength, batch)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>f, <span class="fl">3.850</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>res</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; levene_test(data = ., x = strength, groups = batch)</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; n = 19           k = 3            </span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; F = 3.852032     p-value = 0.04309008 </span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples have unequal variance ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="c11-hk-wf" class="section level3">
<h3>4.1.6 Nonparametric Basis Values</h3>
<p>CMH-17-1G Section 8.3.11.2.1 provides STAT17 outputs for the ETW
condition of the present data set. The nonparametric Basis values are
listed. In this case, the Hanson–Koopmans method is used. The published
A-Basis value is 13.0 and the B-Basis is 37.9.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">basis_hk_ext</span>(strength, <span class="at">method =</span> <span class="st">&quot;woodward-frawley&quot;</span>, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>               <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">13.0</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>res</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(data = ., x = strength, p = 0.99, conf = 0.95, method = &quot;woodward-frawley&quot;, </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, Woodward-Frawley method)     ( n = 22 )</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; 12.99614</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">basis_hk_ext</span>(strength, <span class="at">method =</span> <span class="st">&quot;optimum-order&quot;</span>, <span class="at">p =</span> <span class="fl">0.90</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>               <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">37.9</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>res</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(data = ., x = strength, p = 0.9, conf = 0.95, method = &quot;optimum-order&quot;, </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 22 )</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 37.88511</span></span></code></pre></div>
</div>
<div id="c11-anova" class="section level3">
<h3>4.1.7 Single-Point ANOVA Basis Value</h3>
<p>CMH-17-1G Section 8.3.11.2.2 provides output from STAT17 for the ETW2
condition from the present data set. STAT17 reports A- and B-Basis
values based on the ANOVA method of 34.6 and 63.2, respectively. The
results from <code>cmstatr</code> are similar.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">basis_anova</span>(strength, batch, <span class="at">override =</span> <span class="st">&quot;number_of_groups&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>              <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">34.6</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>res</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; basis_anova(data = ., x = strength, groups = batch, p = 0.99, </span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;     conf = 0.95, override = &quot;number_of_groups&quot;)</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; Distribution:  ANOVA     ( n = 20, r = 3 )</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt;     `number_of_groups`</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; 34.57763</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_1 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">basis_anova</span>(strength, batch, <span class="at">override =</span> <span class="st">&quot;number_of_groups&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">63.2</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>res</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; basis_anova(data = ., x = strength, groups = batch, override = &quot;number_of_groups&quot;)</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  ANOVA     ( n = 20, r = 3 )</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt;     `number_of_groups`</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; 63.20276</span></span></code></pre></div>
</div>
</div>
<div id="dataset-from-section-8.3.11.1.2" class="section level2">
<h2>4.2 Dataset From Section 8.3.11.1.2</h2>
<p><span class="citation">[2]</span> provides an example data set and
results from ASAP <span class="citation">[1]</span>. This example data
set is duplicated below:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>dat_8_3_11_1_2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="sc">~</span>batch, <span class="sc">~</span>strength, <span class="sc">~</span>condition,</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">79.04517</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">103.2006</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">63.22764</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">54.09806</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">102.6014</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">105.1034</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">70.84454</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">58.87615</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">97.79372</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">105.1893</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">66.43223</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">61.60167</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">92.86423</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">1</span>, <span class="fl">100.4189</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">75.37771</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">60.23973</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">117.218</span>,  <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">85.32319</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">72.43773</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">61.4808</span>,  <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">108.7168</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">92.69923</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">68.43073</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">1</span>, <span class="fl">64.55832</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">112.2773</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">98.45242</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">1</span>, <span class="fl">69.72524</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">57.76131</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fl">114.0129</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">104.1014</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">66.20343</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">49.91463</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">106.8452</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">91.51841</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">60.51251</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">61.49271</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">112.3911</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">101.3746</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">65.69334</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">57.7281</span>,  <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">115.5658</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">101.5828</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">62.73595</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">62.11653</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">87.40657</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">99.57384</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">59.00798</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">2</span>, <span class="fl">62.69353</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">102.2785</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">2</span>, <span class="fl">88.84826</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">2</span>, <span class="fl">62.37761</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">61.38523</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">110.6073</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">92.18703</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">64.3947</span>,  <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">60.39053</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">105.2762</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">101.8234</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">72.8491</span>,  <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">59.17616</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">110.8924</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">97.68909</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">66.56226</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">60.17616</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">108.7638</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">101.5172</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">66.56779</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">46.47396</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">110.9833</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">100.0481</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">66.00123</span>, <span class="st">&quot;ETW&quot;</span>, <span class="dv">3</span>, <span class="fl">51.16616</span>, <span class="st">&quot;ETW2&quot;</span>,</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">101.3417</span>, <span class="st">&quot;CTD&quot;</span>, <span class="dv">3</span>, <span class="fl">102.0544</span>, <span class="st">&quot;RTD&quot;</span>, <span class="dv">3</span>, <span class="fl">59.62108</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">100.0251</span>, <span class="st">&quot;CTD&quot;</span>,                     <span class="dv">3</span>, <span class="fl">60.61167</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">57.65487</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">66.51241</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">64.89347</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">57.73054</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">68.94086</span>, <span class="st">&quot;ETW&quot;</span>,</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>                                          <span class="dv">3</span>, <span class="fl">61.63177</span>, <span class="st">&quot;ETW&quot;</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>)</span></code></pre></div>
<div id="c12-psd" class="section level3">
<h3>4.2.1 Pooled SD A- and B-Basis</h3>
<p>CMH-17-1G Table 8.3.11.2(k) provides outputs from ASAP for the data
set above. ASAP uses the pooled SD method. ASAP produces the following
results, which are quite similar to those produced by
<code>cmstatr</code>.</p>
<table>
<thead>
<tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
<th>ETW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>93.64</td>
<td>87.30</td>
<td>54.33</td>
<td>47.12</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>89.19</td>
<td>79.86</td>
<td>46.84</td>
<td>39.69</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_pooled_sd</span>(dat_8_3_11_1_2, strength, condition,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                         <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>           <span class="fl">93.64</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>           <span class="fl">87.30</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>           <span class="fl">54.33</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>],</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>           <span class="fl">47.12</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>res</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; basis_pooled_sd(data = dat_8_3_11_1_2, x = strength, groups = condition, </span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 83, r = 4 )</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;     `pooled_variance_equal`</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; CTD   93.63504 </span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; ETW   54.32706 </span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; ETW2  47.07669 </span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; RTD   87.29555</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_pooled_sd</span>(dat_8_3_11_1_2, strength, condition,</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                       <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>           <span class="fl">86.19</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>           <span class="fl">79.86</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>           <span class="fl">46.84</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>],</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>           <span class="fl">39.69</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>res</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; basis_pooled_sd(data = dat_8_3_11_1_2, x = strength, groups = condition, </span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;     p = 0.99, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 83, r = 4 )</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt;     `pooled_variance_equal`</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt; CTD   86.19301 </span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; ETW   46.84112 </span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; ETW2  39.65214 </span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co">#&gt; RTD   79.86205</span></span></code></pre></div>
</div>
<div id="c12-psdmcv" class="section level3">
<h3>4.2.2 Pooled SD A- and B-Basis (Mod CV)</h3>
<p>After removal of the ETW2 condition, CMH17-STATS reports the pooled
A- and B-Basis (mod CV) shown in the following table.
<code>cmstatr</code> computes very similar values.</p>
<table>
<thead>
<tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>92.25</td>
<td>85.91</td>
<td>52.97</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>83.81</td>
<td>77.48</td>
<td>44.47</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_2 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">!=</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">basis_pooled_sd</span>(strength, condition, <span class="at">modcv =</span> <span class="cn">TRUE</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>             <span class="fl">92.25</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>             <span class="fl">85.91</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>             <span class="fl">52.97</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>res</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt; basis_pooled_sd(data = ., x = strength, groups = condition, modcv = TRUE, </span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 65, r = 3 )</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co">#&gt; Modified CV Approach Used </span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt;     `pooled_variance_equal`</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="co">#&gt; CTD  92.24927 </span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a><span class="co">#&gt; ETW  52.9649 </span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co">#&gt; RTD  85.90454</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_2 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">!=</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">basis_pooled_sd</span>(strength, condition,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                  <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">modcv =</span> <span class="cn">TRUE</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>             <span class="fl">83.81</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>             <span class="fl">77.48</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>             <span class="fl">44.47</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>res</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; basis_pooled_sd(data = ., x = strength, groups = condition, p = 0.99, </span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt;     conf = 0.95, modcv = TRUE, override = &quot;all&quot;)</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled Standard Deviation    ( n = 65, r = 3 )</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; Modified CV Approach Used </span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="co">#&gt;     `pooled_variance_equal`</span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a><span class="co">#&gt; CTD  83.80981 </span></span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a><span class="co">#&gt; ETW  44.47038 </span></span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a><span class="co">#&gt; RTD  77.47589</span></span></code></pre></div>
</div>
<div id="c12-pcv" class="section level3">
<h3>4.2.3 Pooled CV A- and B-Basis</h3>
<p>This data set was input into CMH17-STATS and the Pooled CV method was
selected. The results from CMH17-STATS were as follows.
<code>cmstatr</code> produces very similar results.</p>
<table>
<thead>
<tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
<th>ETW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>90.89</td>
<td>85.37</td>
<td>56.79</td>
<td>50.55</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>81.62</td>
<td>76.67</td>
<td>50.98</td>
<td>45.40</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_pooled_cv</span>(dat_8_3_11_1_2, strength, condition, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>             <span class="fl">90.89</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>             <span class="fl">85.37</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>             <span class="fl">56.79</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>],</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>             <span class="fl">50.55</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>res</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; basis_pooled_cv(data = dat_8_3_11_1_2, x = strength, groups = condition, </span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 83, r = 4 )</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt;     `normalized_variance_equal`</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; CTD   90.88018 </span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; ETW   56.78337 </span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; ETW2  50.54406 </span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; RTD   85.36756</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_pooled_cv</span>(dat_8_3_11_1_2, strength, condition,</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>             <span class="fl">81.62</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>             <span class="fl">76.67</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>             <span class="fl">50.98</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW2&quot;</span>],</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>             <span class="fl">45.40</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>res</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">#&gt; basis_pooled_cv(data = dat_8_3_11_1_2, x = strength, groups = condition, </span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt;     p = 0.99, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 83, r = 4 )</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt;     `normalized_variance_equal`</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; CTD   81.60931 </span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt; ETW   50.97801 </span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">#&gt; ETW2  45.39158 </span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt; RTD   76.66214</span></span></code></pre></div>
</div>
<div id="c12-pcvmcv" class="section level3">
<h3>4.2.4 Pooled CV A- and B-Basis (Mod CV)</h3>
<p>This data set was input into CMH17-STATS and the Pooled CV method was
selected with the modified CV transform. Additionally, the ETW2
condition was removed. The results from CMH17-STATS were as follows.
<code>cmstatr</code> produces very similar results.</p>
<table>
<thead>
<tr class="header">
<th>Condition</th>
<th>CTD</th>
<th>RTD</th>
<th>ETW</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B-Basis</td>
<td>90.31</td>
<td>84.83</td>
<td>56.43</td>
</tr>
<tr class="even">
<td>A-Basis</td>
<td>80.57</td>
<td>75.69</td>
<td>50.33</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_2 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">!=</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">basis_pooled_cv</span>(strength, condition, <span class="at">modcv =</span> <span class="cn">TRUE</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>             <span class="fl">90.31</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>             <span class="fl">84.83</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>             <span class="fl">56.43</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>res</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="co">#&gt; basis_pooled_cv(data = ., x = strength, groups = condition, modcv = TRUE, </span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 65, r = 3 )</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="co">#&gt; Modified CV Approach Used </span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a><span class="co">#&gt;     `normalized_variance_equal`</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a><span class="co">#&gt; CTD  90.30646 </span></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a><span class="co">#&gt; ETW  56.42786 </span></span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a><span class="co">#&gt; RTD  84.82748</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat_8_3_11_1_2 <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">!=</span> <span class="st">&quot;ETW2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">basis_pooled_cv</span>(strength, condition, <span class="at">modcv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>                  <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;CTD&quot;</span>],</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>             <span class="fl">80.57</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;RTD&quot;</span>],</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>             <span class="fl">75.69</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis<span class="sc">$</span>value[res<span class="sc">$</span>basis<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&quot;ETW&quot;</span>],</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>             <span class="fl">50.33</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>res</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; basis_pooled_cv(data = ., x = strength, groups = condition, p = 0.99, </span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co">#&gt;     conf = 0.95, modcv = TRUE, override = &quot;all&quot;)</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal - Pooled CV    ( n = 65, r = 3 )</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="co">#&gt; Modified CV Approach Used </span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="co">#&gt;     `between_group_variability`,</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_group`,</span></span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a><span class="co">#&gt;     `pooled_data_normal`,</span></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a><span class="co">#&gt;     `normalized_variance_equal`</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a><span class="co">#&gt; CTD  80.56529 </span></span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a><span class="co">#&gt; ETW  50.32422 </span></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a><span class="co">#&gt; RTD  75.6817</span></span></code></pre></div>
</div>
</div>
</div>
<div id="other-data-sets" class="section level1">
<h1>5. Other Data Sets</h1>
<p>This section contains various small data sets. In most cases, these
data sets were generated randomly for the purpose of comparing
<code>cmstatr</code> to other software.</p>
<div id="ods-adn" class="section level2">
<h2>5.1 Anderson–Darling Test (Normal)</h2>
<p>The following data set was randomly generated. When this is entered
into STAT17 <span class="citation">[3]</span>, that software gives the
value <span class="math inline">\(OSL = 0.465\)</span>, which matches
the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="at">strength =</span> <span class="fu">c</span>(</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  )</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">anderson_darling_normal</span>(dat, strength)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.465</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>res</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt; anderson_darling_normal(data = dat, x = strength)</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal ( n = 18 ) </span></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 0.2849726 </span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.4648132  (assuming unknown parameters)</span></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is drawn from a Normal distribution ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="ods-adl" class="section level2">
<h2>5.2 Anderson–Darling Test (Lognormal)</h2>
<p>The following data set was randomly generated. When this is entered
into STAT17 <span class="citation">[3]</span>, that software gives the
value <span class="math inline">\(OSL = 0.480\)</span>, which matches
the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="at">strength =</span> <span class="fu">c</span>(</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  )</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">anderson_darling_lognormal</span>(dat, strength)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.480</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>res</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co">#&gt; anderson_darling_lognormal(data = dat, x = strength)</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co">#&gt; Distribution:  Lognormal ( n = 18 ) </span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 0.2774652 </span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.4798148  (assuming unknown parameters)</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is drawn from a Lognormal distribution ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="ods-adw" class="section level2">
<h2>5.3 Anderson–Darling Test (Weibull)</h2>
<p>The following data set was randomly generated. When this is entered
into STAT17 <span class="citation">[3]</span>, that software gives the
value <span class="math inline">\(OSL = 0.179\)</span>, which matches
the result of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  <span class="at">strength =</span> <span class="fu">c</span>(</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>    <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.89</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>    <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.283</span>, <span class="fl">143.5429</span>,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>    <span class="fl">141.7023</span>, <span class="fl">137.4732</span>, <span class="fl">152.338</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  )</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">anderson_darling_weibull</span>(dat, strength)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>osl, <span class="fl">0.179</span>, <span class="at">tolerance =</span> <span class="fl">0.002</span>)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>res</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="co">#&gt; anderson_darling_weibull(data = dat, x = strength)</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a><span class="co">#&gt; Distribution:  Weibull ( n = 18 ) </span></span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a><span class="co">#&gt; Test statistic:  A = 0.5113909 </span></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a><span class="co">#&gt; OSL (p-value):  0.1787882  (assuming unknown parameters)</span></span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a><span class="co">#&gt; Conclusion: Sample is drawn from a Weibull distribution ( alpha = 0.05 )</span></span></code></pre></div>
</div>
<div id="ods-nb" class="section level2">
<h2>5.4 Normal A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis
values were computed assuming normally distributed data. The results
were 120.336 and 129.287, respectively. <code>cmstatr</code> reports
very similar values.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_normal</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">120.336</span>, <span class="at">tolerance =</span> <span class="fl">0.0005</span>)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>res</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="co">#&gt; basis_normal(x = dat, p = 0.99, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal    ( n = 18 )</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_normal`</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co">#&gt; 120.3549</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_normal</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">129.287</span>, <span class="at">tolerance =</span> <span class="fl">0.0005</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>res</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co">#&gt; basis_normal(x = dat, p = 0.9, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co">#&gt; Distribution:  Normal    ( n = 18 )</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_normal`</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="co">#&gt; 129.2898</span></span></code></pre></div>
</div>
<div id="ods-lb" class="section level2">
<h2>5.5 Lognormal A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis
values were computed assuming distributed according to a lognormal
distribution. The results were 121.710 and 129.664, respectively.
<code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_lognormal</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">121.710</span>, <span class="at">tolerance =</span> <span class="fl">0.0005</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>res</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="co">#&gt; basis_lognormal(x = dat, p = 0.99, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="co">#&gt; Distribution:  Lognormal     ( n = 18 )</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_lognormal`</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="co">#&gt; 121.7265</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_lognormal</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">129.664</span>, <span class="at">tolerance =</span> <span class="fl">0.0005</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>res</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#&gt; basis_lognormal(x = dat, p = 0.9, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co">#&gt; Distribution:  Lognormal     ( n = 18 )</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_lognormal`</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="co">#&gt; 129.667</span></span></code></pre></div>
</div>
<div id="ods-wb" class="section level2">
<h2>5.6 Weibull A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis
values were computed assuming data following the Weibull distribution.
The results were 109.150 and 125.441, respectively. <code>cmstatr</code>
reports very similar values.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_weibull</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">109.150</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>res</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#&gt; basis_weibull(x = dat, p = 0.99, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a><span class="co">#&gt; Distribution:  Weibull   ( n = 18 )</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_weibull`</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a><span class="co">#&gt; 109.651</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_weibull</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">125.441</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>res</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="co">#&gt; basis_weibull(x = dat, p = 0.9, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a><span class="co">#&gt; Distribution:  Weibull   ( n = 18 )</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a><span class="co">#&gt;     `anderson_darling_weibull`</span></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a><span class="co">#&gt; 125.7338</span></span></code></pre></div>
</div>
<div id="ods-hkb" class="section level2">
<h2>5.7 Extended Hanson–Koopmans A- and B-Basis</h2>
<p>The following data was input into STAT17 and the A- and B-Basis
values were computed using the nonparametric (small sample) method. The
results were 99.651 and 124.156, respectively. <code>cmstatr</code>
reports very similar values.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  <span class="fl">137.4438</span>, <span class="fl">139.5395</span>, <span class="fl">150.8900</span>, <span class="fl">141.4474</span>, <span class="fl">141.8203</span>, <span class="fl">151.8821</span>, <span class="fl">143.9245</span>,</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="fl">132.9732</span>, <span class="fl">136.6419</span>, <span class="fl">138.1723</span>, <span class="fl">148.7668</span>, <span class="fl">143.2830</span>, <span class="fl">143.5429</span>, <span class="fl">141.7023</span>,</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="fl">137.4732</span>, <span class="fl">152.3380</span>, <span class="fl">144.1589</span>, <span class="fl">128.5218</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_hk_ext</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;woodward-frawley&quot;</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">99.651</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>res</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(x = dat, p = 0.99, conf = 0.95, method = &quot;woodward-frawley&quot;, </span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, Woodward-Frawley method)     ( n = 18 )</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a><span class="co">#&gt; A-Basis:   ( p = 0.99 , conf = 0.95 )</span></span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a><span class="co">#&gt; 99.65098</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_hk_ext</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;optimum-order&quot;</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">124.156</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>res</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(x = dat, p = 0.9, conf = 0.95, method = &quot;optimum-order&quot;, </span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 18 )</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a><span class="co">#&gt; 124.1615</span></span></code></pre></div>
</div>
<div id="ods-hkb2" class="section level2">
<h2>5.8 Extended Hanson–Koopmans B-Basis</h2>
<p>The following random numbers were generated.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>  <span class="fl">139.6734</span>, <span class="fl">143.0032</span>, <span class="fl">130.4757</span>, <span class="fl">144.8327</span>, <span class="fl">138.7818</span>, <span class="fl">136.7693</span>, <span class="fl">148.636</span>,</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fl">131.0095</span>, <span class="fl">131.4933</span>, <span class="fl">142.8856</span>, <span class="fl">158.0198</span>, <span class="fl">145.2271</span>, <span class="fl">137.5991</span>, <span class="fl">139.8298</span>,</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fl">140.8557</span>, <span class="fl">137.6148</span>, <span class="fl">131.3614</span>, <span class="fl">152.7795</span>, <span class="fl">145.8792</span>, <span class="fl">152.9207</span>, <span class="fl">160.0989</span>,</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fl">145.1920</span>, <span class="fl">128.6383</span>, <span class="fl">141.5992</span>, <span class="fl">122.5297</span>, <span class="fl">159.8209</span>, <span class="fl">151.6720</span>, <span class="fl">159.0156</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>)</span></code></pre></div>
<p>All of the numbers above were input into STAT17 and the reported
B-Basis value using the Optimum Order nonparametric method was
122.36798. This result matches the results of <code>cmstatr</code>
within a small margin.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_hk_ext</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;optimum-order&quot;</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">122.36798</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>res</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(x = dat, p = 0.9, conf = 0.95, method = &quot;optimum-order&quot;, </span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 28 )</span></span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a><span class="co">#&gt; 122.3638</span></span></code></pre></div>
<p>The last two observations from the above data set were discarded,
leaving 26 observations. This smaller data set was input into STAT17 and
that software calculated a B-Basis value of 121.57073 using the Optimum
Order nonparametric method. <code>cmstatr</code> reports a very similar
number.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_hk_ext</span>(<span class="at">x =</span> <span class="fu">head</span>(dat, <span class="dv">26</span>), <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;optimum-order&quot;</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">121.57073</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>res</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(x = head(dat, 26), p = 0.9, conf = 0.95, method = &quot;optimum-order&quot;, </span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 26 )</span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a><span class="co">#&gt; 121.5655</span></span></code></pre></div>
<p>The same data set was further reduced such that only the first 22
observations were included. This smaller data set was input into STAT17
and that software calculated a B-Basis value of 128.82397 using the
Optimum Order nonparametric method. <code>cmstatr</code> reports a very
similar number.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_hk_ext</span>(<span class="at">x =</span> <span class="fu">head</span>(dat, <span class="dv">22</span>), <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">&quot;optimum-order&quot;</span>, <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">128.82397</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>res</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="co">#&gt; basis_hk_ext(x = head(dat, 22), p = 0.9, conf = 0.95, method = &quot;optimum-order&quot;, </span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="co">#&gt;     override = &quot;all&quot;)</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (Extended Hanson-Koopmans, optimum two-order-statistic method)  ( n = 22 )</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="co">#&gt;     `correct_method_used`,</span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a><span class="co">#&gt; 128.8224</span></span></code></pre></div>
</div>
<div id="ods-lsnb" class="section level2">
<h2>5.9 Large Sample Nonparametric B-Basis</h2>
<p>The following data was input into STAT17 and the B-Basis value was
computed using the nonparametric (large sample) method. The results was
122.738297. <code>cmstatr</code> reports very similar values.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  <span class="fl">137.3603</span>, <span class="fl">135.6665</span>, <span class="fl">136.6914</span>, <span class="fl">154.7919</span>, <span class="fl">159.2037</span>, <span class="fl">137.3277</span>, <span class="fl">128.821</span>,</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  <span class="fl">138.6304</span>, <span class="fl">138.9004</span>, <span class="fl">147.4598</span>, <span class="fl">148.6622</span>, <span class="fl">144.4948</span>, <span class="fl">131.0851</span>, <span class="fl">149.0203</span>,</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="fl">131.8232</span>, <span class="fl">146.4471</span>, <span class="fl">123.8124</span>, <span class="fl">126.3105</span>, <span class="fl">140.7609</span>, <span class="fl">134.4875</span>, <span class="fl">128.7508</span>,</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  <span class="fl">117.1854</span>, <span class="fl">129.3088</span>, <span class="fl">141.6789</span>, <span class="fl">138.4073</span>, <span class="fl">136.0295</span>, <span class="fl">128.4164</span>, <span class="fl">141.7733</span>,</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  <span class="fl">134.455</span>,  <span class="fl">122.7383</span>, <span class="fl">136.9171</span>, <span class="fl">136.9232</span>, <span class="fl">138.8402</span>, <span class="fl">152.8294</span>, <span class="fl">135.0633</span>,</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>  <span class="fl">121.052</span>,  <span class="fl">131.035</span>,  <span class="fl">138.3248</span>, <span class="fl">131.1379</span>, <span class="fl">147.3771</span>, <span class="fl">130.0681</span>, <span class="fl">132.7467</span>,</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  <span class="fl">137.1444</span>, <span class="fl">141.662</span>,  <span class="fl">146.9363</span>, <span class="fl">160.7448</span>, <span class="fl">138.5511</span>, <span class="fl">129.1628</span>, <span class="fl">140.2939</span>,</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  <span class="fl">144.8167</span>, <span class="fl">156.5918</span>, <span class="fl">132.0099</span>, <span class="fl">129.3551</span>, <span class="fl">136.6066</span>, <span class="fl">134.5095</span>, <span class="fl">128.2081</span>,</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  <span class="fl">144.0896</span>, <span class="fl">141.8029</span>, <span class="fl">130.0149</span>, <span class="fl">140.8813</span>, <span class="fl">137.7864</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>)</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">basis_nonpara_large_sample</span>(<span class="at">x =</span> dat, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>                                  <span class="at">override =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>basis, <span class="fl">122.738297</span>, <span class="at">tolerance =</span> <span class="fl">0.005</span>)</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>res</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="co">#&gt; basis_nonpara_large_sample(x = dat, p = 0.9, conf = 0.95, override = &quot;all&quot;)</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="co">#&gt; Distribution:  Nonparametric (large sample)  ( n = 61 )</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a><span class="co">#&gt; The following diagnostic tests were overridden:</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a><span class="co">#&gt;     `outliers_within_batch`,</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="co">#&gt;     `between_batch_variability`,</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a><span class="co">#&gt;     `outliers`,</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a><span class="co">#&gt;     `sample_size`</span></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a><span class="co">#&gt; B-Basis:   ( p = 0.9 , conf = 0.95 )</span></span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a><span class="co">#&gt; 122.7383</span></span></code></pre></div>
</div>
<div id="ods-eme" class="section level2">
<h2>5.10 Acceptance Limits Based on Mean and Extremum</h2>
<p>Results from <code>cmstatr</code>’s <code>equiv_mean_extremum</code>
function were compared with results from HYTEQ. The summary statistics
for the qualification data were set as <code>mean = 141.310</code> and
<code>sd=6.415</code>. For a value of <code>alpha=0.05</code> and
<code>n = 9</code>, HYTEQ reported thresholds of 123.725 and 137.197 for
minimum individual and mean, respectively. <code>cmstatr</code> produces
very similar results.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">equiv_mean_extremum</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean_qual =</span> <span class="fl">141.310</span>, <span class="at">sd_qual =</span> <span class="fl">6.415</span>,</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>                           <span class="at">n_sample =</span> <span class="dv">9</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold_min_indiv, <span class="fl">123.725</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold_mean, <span class="fl">137.197</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>res</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="co">#&gt; equiv_mean_extremum(mean_qual = 141.31, sd_qual = 6.415, n_sample = 9, </span></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="co">#&gt;     alpha = 0.05)</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="co">#&gt; For alpha = 0.05 and n = 9 </span></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a><span class="co">#&gt; ( k1 = 2.741054 and k2 = 0.6410852 )</span></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="co">#&gt;                   Min Individual    Sample Mean    </span></span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a><span class="co">#&gt;      Thresholds:     123.7261         137.1974</span></span></code></pre></div>
<p>Using the same parameters, but using the modified CV method, HYTEQ
produces thresholds of 117.024 and 135.630 for minimum individual and
mean, respectively. <code>cmstatr</code> produces very similar
results.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">equiv_mean_extremum</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">mean_qual =</span> <span class="fl">141.310</span>, <span class="at">sd_qual =</span> <span class="fl">6.415</span>,</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>                           <span class="at">n_sample =</span> <span class="dv">9</span>, <span class="at">modcv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold_min_indiv, <span class="fl">117.024</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold_mean, <span class="fl">135.630</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>res</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="co">#&gt; equiv_mean_extremum(mean_qual = 141.31, sd_qual = 6.415, n_sample = 9, </span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a><span class="co">#&gt;     alpha = 0.05, modcv = TRUE)</span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="co">#&gt; Modified CV used: CV* = 0.06269832 ( CV = 0.04539665 )</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a><span class="co">#&gt; For alpha = 0.05 and n = 9 </span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="co">#&gt; ( k1 = 2.741054 and k2 = 0.6410852 )</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a><span class="co">#&gt;                   Min Individual    Sample Mean    </span></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="co">#&gt;      Thresholds:     117.0245          135.63</span></span></code></pre></div>
</div>
<div id="ods-ecm" class="section level2">
<h2>5.11 Acceptance Based on Change in Mean</h2>
<p>Results from <code>cmstatr</code>’s <code>equiv_change_mean</code>
function were compared with results from HYTEQ. The following parameters
were used. A value of <code>alpha = 0.05</code> was selected.</p>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Qualification</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>9.24</td>
<td>9.02</td>
</tr>
<tr class="even">
<td>SD</td>
<td>0.162</td>
<td>0.15785</td>
</tr>
<tr class="odd">
<td>n</td>
<td>28</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>HYTEQ gives an acceptance range of 9.115 to 9.365.
<code>cmstatr</code> produces similar results.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">equiv_change_mean</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">n_sample =</span> <span class="dv">9</span>, <span class="at">mean_sample =</span> <span class="fl">9.02</span>,</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>                         <span class="at">sd_sample =</span> <span class="fl">0.15785</span>, <span class="at">n_qual =</span> <span class="dv">28</span>, <span class="at">mean_qual =</span> <span class="fl">9.24</span>,</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>                         <span class="at">sd_qual =</span> <span class="fl">0.162</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold, <span class="fu">c</span>(<span class="fl">9.115</span>, <span class="fl">9.365</span>), <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>res</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a><span class="co">#&gt; equiv_change_mean(n_qual = 28, mean_qual = 9.24, sd_qual = 0.162, </span></span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a><span class="co">#&gt;     n_sample = 9, mean_sample = 9.02, sd_sample = 0.15785, alpha = 0.05)</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a><span class="co">#&gt; For alpha = 0.05 </span></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="co">#&gt;                   Qualification        Sample      </span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a><span class="co">#&gt;           Number        28               9         </span></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a><span class="co">#&gt;             Mean       9.24             9.02       </span></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="co">#&gt;               SD      0.162           0.15785      </span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a><span class="co">#&gt;        Pooled SD            0.1610609             </span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a><span class="co">#&gt;               t0            -3.564775             </span></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a><span class="co">#&gt;           Result               FAIL               </span></span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a><span class="co">#&gt;    Passing Range       9.114712 to 9.365288</span></span></code></pre></div>
<p>After selecting the modified CV method, HYTEQ gives an acceptance
range of 8.857 to 9.623. <code>cmstatr</code> produces similar
results.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">equiv_change_mean</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">n_sample =</span> <span class="dv">9</span>, <span class="at">mean_sample =</span> <span class="fl">9.02</span>,</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>                         <span class="at">sd_sample =</span> <span class="fl">0.15785</span>, <span class="at">n_qual =</span> <span class="dv">28</span>, <span class="at">mean_qual =</span> <span class="fl">9.24</span>,</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>                         <span class="at">sd_qual =</span> <span class="fl">0.162</span>, <span class="at">modcv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>threshold, <span class="fu">c</span>(<span class="fl">8.857</span>, <span class="fl">9.623</span>), <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>res</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="co">#&gt; equiv_change_mean(n_qual = 28, mean_qual = 9.24, sd_qual = 0.162, </span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a><span class="co">#&gt;     n_sample = 9, mean_sample = 9.02, sd_sample = 0.15785, alpha = 0.05, </span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a><span class="co">#&gt;     modcv = TRUE)</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="co">#&gt; For alpha = 0.05 </span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a><span class="co">#&gt; Modified CV used</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="co">#&gt;                   Qualification        Sample      </span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a><span class="co">#&gt;           Number        28               9         </span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a><span class="co">#&gt;             Mean       9.24             9.02       </span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a><span class="co">#&gt;               SD      0.162           0.15785      </span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a><span class="co">#&gt;        Pooled SD            0.4927484             </span></span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a><span class="co">#&gt;               t0             -1.16519             </span></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a><span class="co">#&gt;           Result               PASS               </span></span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a><span class="co">#&gt;    Passing Range       8.856695 to 9.623305</span></span></code></pre></div>
</div>
</div>
<div id="comparison-with-literature" class="section level1">
<h1>6. Comparison with Literature</h1>
<p>In this section, results from <code>cmstatr</code> are compared with
values published in literature.</p>
<div id="cl-adk" class="section level2">
<h2>6.1 Anderson–Darling K–Sample Test</h2>
<p><span class="citation">[4]</span> provides example data that compares
measurements obtained in four labs. Their paper gives values of the ADK
test statistic as well as p-values.</p>
<p>The data in <span class="citation">[4]</span> is as follows:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>dat_ss1987 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  <span class="at">smoothness =</span> <span class="fu">c</span>(</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>    <span class="fl">38.7</span>, <span class="fl">41.5</span>, <span class="fl">43.8</span>, <span class="fl">44.5</span>, <span class="fl">45.5</span>, <span class="fl">46.0</span>, <span class="fl">47.7</span>, <span class="fl">58.0</span>,</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>    <span class="fl">39.2</span>, <span class="fl">39.3</span>, <span class="fl">39.7</span>, <span class="fl">41.4</span>, <span class="fl">41.8</span>, <span class="fl">42.9</span>, <span class="fl">43.3</span>, <span class="fl">45.8</span>,</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>    <span class="fl">34.0</span>, <span class="fl">35.0</span>, <span class="fl">39.0</span>, <span class="fl">40.0</span>, <span class="fl">43.0</span>, <span class="fl">43.0</span>, <span class="fl">44.0</span>, <span class="fl">45.0</span>,</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>    <span class="fl">34.0</span>, <span class="fl">34.8</span>, <span class="fl">34.8</span>, <span class="fl">35.4</span>, <span class="fl">37.2</span>, <span class="fl">37.8</span>, <span class="fl">41.2</span>, <span class="fl">42.8</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  ),</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  <span class="at">lab =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;D&quot;</span>, <span class="dv">8</span>))</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>dat_ss1987</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="co">#&gt;    smoothness lab</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a><span class="co">#&gt; 1        38.7   A</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a><span class="co">#&gt; 2        41.5   A</span></span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a><span class="co">#&gt; 3        43.8   A</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a><span class="co">#&gt; 4        44.5   A</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a><span class="co">#&gt; 5        45.5   A</span></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a><span class="co">#&gt; 6        46.0   A</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a><span class="co">#&gt; 7        47.7   A</span></span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a><span class="co">#&gt; 8        58.0   A</span></span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a><span class="co">#&gt; 9        39.2   B</span></span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a><span class="co">#&gt; 10       39.3   B</span></span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a><span class="co">#&gt; 11       39.7   B</span></span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a><span class="co">#&gt; 12       41.4   B</span></span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a><span class="co">#&gt; 13       41.8   B</span></span>
<span id="cb50-25"><a href="#cb50-25" tabindex="-1"></a><span class="co">#&gt; 14       42.9   B</span></span>
<span id="cb50-26"><a href="#cb50-26" tabindex="-1"></a><span class="co">#&gt; 15       43.3   B</span></span>
<span id="cb50-27"><a href="#cb50-27" tabindex="-1"></a><span class="co">#&gt; 16       45.8   B</span></span>
<span id="cb50-28"><a href="#cb50-28" tabindex="-1"></a><span class="co">#&gt; 17       34.0   C</span></span>
<span id="cb50-29"><a href="#cb50-29" tabindex="-1"></a><span class="co">#&gt; 18       35.0   C</span></span>
<span id="cb50-30"><a href="#cb50-30" tabindex="-1"></a><span class="co">#&gt; 19       39.0   C</span></span>
<span id="cb50-31"><a href="#cb50-31" tabindex="-1"></a><span class="co">#&gt; 20       40.0   C</span></span>
<span id="cb50-32"><a href="#cb50-32" tabindex="-1"></a><span class="co">#&gt; 21       43.0   C</span></span>
<span id="cb50-33"><a href="#cb50-33" tabindex="-1"></a><span class="co">#&gt; 22       43.0   C</span></span>
<span id="cb50-34"><a href="#cb50-34" tabindex="-1"></a><span class="co">#&gt; 23       44.0   C</span></span>
<span id="cb50-35"><a href="#cb50-35" tabindex="-1"></a><span class="co">#&gt; 24       45.0   C</span></span>
<span id="cb50-36"><a href="#cb50-36" tabindex="-1"></a><span class="co">#&gt; 25       34.0   D</span></span>
<span id="cb50-37"><a href="#cb50-37" tabindex="-1"></a><span class="co">#&gt; 26       34.8   D</span></span>
<span id="cb50-38"><a href="#cb50-38" tabindex="-1"></a><span class="co">#&gt; 27       34.8   D</span></span>
<span id="cb50-39"><a href="#cb50-39" tabindex="-1"></a><span class="co">#&gt; 28       35.4   D</span></span>
<span id="cb50-40"><a href="#cb50-40" tabindex="-1"></a><span class="co">#&gt; 29       37.2   D</span></span>
<span id="cb50-41"><a href="#cb50-41" tabindex="-1"></a><span class="co">#&gt; 30       37.8   D</span></span>
<span id="cb50-42"><a href="#cb50-42" tabindex="-1"></a><span class="co">#&gt; 31       41.2   D</span></span>
<span id="cb50-43"><a href="#cb50-43" tabindex="-1"></a><span class="co">#&gt; 32       42.8   D</span></span></code></pre></div>
<p><span class="citation">[4]</span> lists the corresponding test
statistics <span class="math inline">\(A_{akN}^2 = 8.3926\)</span> and
<span class="math inline">\(\sigma_N = 1.2038\)</span> with the p-value
<span class="math inline">\(p = 0.0022\)</span>. These match the result
of <code>cmstatr</code> within a small margin.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">ad_ksample</span>(dat_ss1987, smoothness, lab)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>ad, <span class="fl">8.3926</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>sigma, <span class="fl">1.2038</span>, <span class="at">tolerance =</span> <span class="fl">0.001</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="fu">expect_equal</span>(res<span class="sc">$</span>p, <span class="fl">0.00226</span>, <span class="at">tolerance =</span> <span class="fl">0.01</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>res</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a><span class="co">#&gt; ad_ksample(data = dat_ss1987, x = smoothness, groups = lab)</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a><span class="co">#&gt; N = 32           k = 4            </span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a><span class="co">#&gt; ADK = 8.39       p-value = 0.002255 </span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="co">#&gt; Conclusion: Samples do not come from the same distribution (alpha = 0.025 )</span></span></code></pre></div>
</div>
</div>
<div id="comparison-with-published-factors" class="section level1">
<h1>7. Comparison with Published Factors</h1>
<p>Various factors, such as tolerance limit factors, are published in
various publications. This section compares those published factors with
those computed by <code>cmstatr</code>.</p>
<div id="pf-kb" class="section level2">
<h2>7.1 Normal kB Factors</h2>
<p>B-Basis tolerance limit factors assuming a normal distribution are
published in CMH-17-1G. Those factors are reproduced below and are
compared with the results of <code>cmstatr</code>. The published factors
and those computed by <code>cmstatr</code> are quite similar.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>kB_published,</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">20.581</span>, <span class="dv">36</span>, <span class="fl">1.725</span>, <span class="dv">70</span>, <span class="fl">1.582</span>, <span class="dv">104</span>, <span class="fl">1.522</span>,</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">6.157</span>, <span class="dv">37</span>, <span class="fl">1.718</span>, <span class="dv">71</span>, <span class="fl">1.579</span>, <span class="dv">105</span>, <span class="fl">1.521</span>,</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="dv">4</span>, <span class="fl">4.163</span>, <span class="dv">38</span>, <span class="fl">1.711</span>, <span class="dv">72</span>, <span class="fl">1.577</span>, <span class="dv">106</span>, <span class="fl">1.519</span>,</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  <span class="dv">5</span>, <span class="fl">3.408</span>, <span class="dv">39</span>, <span class="fl">1.704</span>, <span class="dv">73</span>, <span class="fl">1.575</span>, <span class="dv">107</span>, <span class="fl">1.518</span>,</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>  <span class="dv">6</span>, <span class="fl">3.007</span>, <span class="dv">40</span>, <span class="fl">1.698</span>, <span class="dv">74</span>, <span class="fl">1.572</span>, <span class="dv">108</span>, <span class="fl">1.517</span>,</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  <span class="dv">7</span>, <span class="fl">2.756</span>, <span class="dv">41</span>, <span class="fl">1.692</span>, <span class="dv">75</span>, <span class="fl">1.570</span>, <span class="dv">109</span>, <span class="fl">1.516</span>,</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  <span class="dv">8</span>, <span class="fl">2.583</span>, <span class="dv">42</span>, <span class="fl">1.686</span>, <span class="dv">76</span>, <span class="fl">1.568</span>, <span class="dv">110</span>, <span class="fl">1.515</span>,</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  <span class="dv">9</span>, <span class="fl">2.454</span>, <span class="dv">43</span>, <span class="fl">1.680</span>, <span class="dv">77</span>, <span class="fl">1.566</span>, <span class="dv">111</span>, <span class="fl">1.513</span>,</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>  <span class="dv">10</span>, <span class="fl">2.355</span>, <span class="dv">44</span>, <span class="fl">1.675</span>, <span class="dv">78</span>, <span class="fl">1.564</span>, <span class="dv">112</span>, <span class="fl">1.512</span>,</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>  <span class="dv">11</span>, <span class="fl">2.276</span>, <span class="dv">45</span>, <span class="fl">1.669</span>, <span class="dv">79</span>, <span class="fl">1.562</span>, <span class="dv">113</span>, <span class="fl">1.511</span>,</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>  <span class="dv">12</span>, <span class="fl">2.211</span>, <span class="dv">46</span>, <span class="fl">1.664</span>, <span class="dv">80</span>, <span class="fl">1.560</span>, <span class="dv">114</span>, <span class="fl">1.510</span>,</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>  <span class="dv">13</span>, <span class="fl">2.156</span>, <span class="dv">47</span>, <span class="fl">1.660</span>, <span class="dv">81</span>, <span class="fl">1.558</span>, <span class="dv">115</span>, <span class="fl">1.509</span>,</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  <span class="dv">14</span>, <span class="fl">2.109</span>, <span class="dv">48</span>, <span class="fl">1.655</span>, <span class="dv">82</span>, <span class="fl">1.556</span>, <span class="dv">116</span>, <span class="fl">1.508</span>,</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>  <span class="dv">15</span>, <span class="fl">2.069</span>, <span class="dv">49</span>, <span class="fl">1.650</span>, <span class="dv">83</span>, <span class="fl">1.554</span>, <span class="dv">117</span>, <span class="fl">1.507</span>,</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>  <span class="dv">16</span>, <span class="fl">2.034</span>, <span class="dv">50</span>, <span class="fl">1.646</span>, <span class="dv">84</span>, <span class="fl">1.552</span>, <span class="dv">118</span>, <span class="fl">1.506</span>,</span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>  <span class="dv">17</span>, <span class="fl">2.002</span>, <span class="dv">51</span>, <span class="fl">1.642</span>, <span class="dv">85</span>, <span class="fl">1.551</span>, <span class="dv">119</span>, <span class="fl">1.505</span>,</span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>  <span class="dv">18</span>, <span class="fl">1.974</span>, <span class="dv">52</span>, <span class="fl">1.638</span>, <span class="dv">86</span>, <span class="fl">1.549</span>, <span class="dv">120</span>, <span class="fl">1.504</span>,</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>  <span class="dv">19</span>, <span class="fl">1.949</span>, <span class="dv">53</span>, <span class="fl">1.634</span>, <span class="dv">87</span>, <span class="fl">1.547</span>, <span class="dv">121</span>, <span class="fl">1.503</span>,</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a>  <span class="dv">20</span>, <span class="fl">1.927</span>, <span class="dv">54</span>, <span class="fl">1.630</span>, <span class="dv">88</span>, <span class="fl">1.545</span>, <span class="dv">122</span>, <span class="fl">1.502</span>,</span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>  <span class="dv">21</span>, <span class="fl">1.906</span>, <span class="dv">55</span>, <span class="fl">1.626</span>, <span class="dv">89</span>, <span class="fl">1.544</span>, <span class="dv">123</span>, <span class="fl">1.501</span>,</span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>  <span class="dv">22</span>, <span class="fl">1.887</span>, <span class="dv">56</span>, <span class="fl">1.623</span>, <span class="dv">90</span>, <span class="fl">1.542</span>, <span class="dv">124</span>, <span class="fl">1.500</span>,</span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>  <span class="dv">23</span>, <span class="fl">1.870</span>, <span class="dv">57</span>, <span class="fl">1.619</span>, <span class="dv">91</span>, <span class="fl">1.540</span>, <span class="dv">125</span>, <span class="fl">1.499</span>,</span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>  <span class="dv">24</span>, <span class="fl">1.854</span>, <span class="dv">58</span>, <span class="fl">1.616</span>, <span class="dv">92</span>, <span class="fl">1.539</span>, <span class="dv">126</span>, <span class="fl">1.498</span>,</span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>  <span class="dv">25</span>, <span class="fl">1.839</span>, <span class="dv">59</span>, <span class="fl">1.613</span>, <span class="dv">93</span>, <span class="fl">1.537</span>, <span class="dv">127</span>, <span class="fl">1.497</span>,</span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>  <span class="dv">26</span>, <span class="fl">1.825</span>, <span class="dv">60</span>, <span class="fl">1.609</span>, <span class="dv">94</span>, <span class="fl">1.536</span>, <span class="dv">128</span>, <span class="fl">1.496</span>,</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>  <span class="dv">27</span>, <span class="fl">1.812</span>, <span class="dv">61</span>, <span class="fl">1.606</span>, <span class="dv">95</span>, <span class="fl">1.534</span>, <span class="dv">129</span>, <span class="fl">1.495</span>,</span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a>  <span class="dv">28</span>, <span class="fl">1.800</span>, <span class="dv">62</span>, <span class="fl">1.603</span>, <span class="dv">96</span>, <span class="fl">1.533</span>, <span class="dv">130</span>, <span class="fl">1.494</span>,</span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a>  <span class="dv">29</span>, <span class="fl">1.789</span>, <span class="dv">63</span>, <span class="fl">1.600</span>, <span class="dv">97</span>, <span class="fl">1.531</span>, <span class="dv">131</span>, <span class="fl">1.493</span>,</span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a>  <span class="dv">30</span>, <span class="fl">1.778</span>, <span class="dv">64</span>, <span class="fl">1.597</span>, <span class="dv">98</span>, <span class="fl">1.530</span>, <span class="dv">132</span>, <span class="fl">1.492</span>,</span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a>  <span class="dv">31</span>, <span class="fl">1.768</span>, <span class="dv">65</span>, <span class="fl">1.595</span>, <span class="dv">99</span>, <span class="fl">1.529</span>, <span class="dv">133</span>, <span class="fl">1.492</span>,</span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a>  <span class="dv">32</span>, <span class="fl">1.758</span>, <span class="dv">66</span>, <span class="fl">1.592</span>, <span class="dv">100</span>, <span class="fl">1.527</span>, <span class="dv">134</span>, <span class="fl">1.491</span>,</span>
<span id="cb52-34"><a href="#cb52-34" tabindex="-1"></a>  <span class="dv">33</span>, <span class="fl">1.749</span>, <span class="dv">67</span>, <span class="fl">1.589</span>, <span class="dv">101</span>, <span class="fl">1.526</span>, <span class="dv">135</span>, <span class="fl">1.490</span>,</span>
<span id="cb52-35"><a href="#cb52-35" tabindex="-1"></a>  <span class="dv">34</span>, <span class="fl">1.741</span>, <span class="dv">68</span>, <span class="fl">1.587</span>, <span class="dv">102</span>, <span class="fl">1.525</span>, <span class="dv">136</span>, <span class="fl">1.489</span>,</span>
<span id="cb52-36"><a href="#cb52-36" tabindex="-1"></a>  <span class="dv">35</span>, <span class="fl">1.733</span>, <span class="dv">69</span>, <span class="fl">1.584</span>, <span class="dv">103</span>, <span class="fl">1.523</span>, <span class="dv">137</span>, <span class="fl">1.488</span></span>
<span id="cb52-37"><a href="#cb52-37" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb52-38"><a href="#cb52-38" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb52-39"><a href="#cb52-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kB_cmstatr =</span> <span class="fu">k_factor_normal</span>(n, <span class="at">p =</span> <span class="fl">0.9</span>, <span class="at">conf =</span> <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-40"><a href="#cb52-40" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-41"><a href="#cb52-41" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">expect_equal</span>(kB_published, kB_cmstatr, <span class="at">tolerance =</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-42"><a href="#cb52-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(diff))</span>
<span id="cb52-43"><a href="#cb52-43" tabindex="-1"></a><span class="co">#&gt; # A tibble: 136 × 3</span></span>
<span id="cb52-44"><a href="#cb52-44" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb52-45"><a href="#cb52-45" tabindex="-1"></a><span class="co">#&gt;        n kB_published kB_cmstatr</span></span>
<span id="cb52-46"><a href="#cb52-46" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb52-47"><a href="#cb52-47" tabindex="-1"></a><span class="co">#&gt;  1     2        20.6       20.6 </span></span>
<span id="cb52-48"><a href="#cb52-48" tabindex="-1"></a><span class="co">#&gt;  2     3         6.16       6.16</span></span>
<span id="cb52-49"><a href="#cb52-49" tabindex="-1"></a><span class="co">#&gt;  3     4         4.16       4.16</span></span>
<span id="cb52-50"><a href="#cb52-50" tabindex="-1"></a><span class="co">#&gt;  4     5         3.41       3.41</span></span>
<span id="cb52-51"><a href="#cb52-51" tabindex="-1"></a><span class="co">#&gt;  5     6         3.01       3.01</span></span>
<span id="cb52-52"><a href="#cb52-52" tabindex="-1"></a><span class="co">#&gt;  6     7         2.76       2.76</span></span>
<span id="cb52-53"><a href="#cb52-53" tabindex="-1"></a><span class="co">#&gt;  7     8         2.58       2.58</span></span>
<span id="cb52-54"><a href="#cb52-54" tabindex="-1"></a><span class="co">#&gt;  8     9         2.45       2.45</span></span>
<span id="cb52-55"><a href="#cb52-55" tabindex="-1"></a><span class="co">#&gt;  9    10         2.36       2.35</span></span>
<span id="cb52-56"><a href="#cb52-56" tabindex="-1"></a><span class="co">#&gt; 10    11         2.28       2.28</span></span>
<span id="cb52-57"><a href="#cb52-57" tabindex="-1"></a><span class="co">#&gt; # ℹ 126 more rows</span></span></code></pre></div>
</div>
<div id="pf-ka" class="section level2">
<h2>7.2 Normal kA Factors</h2>
<p>A-Basis tolerance limit factors assuming a normal distribution are
published in CMH-17-1G. Those factors are reproduced below and are
compared with the results of <code>cmstatr</code>. The published factors
and those computed by <code>cmstatr</code> are quite similar.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>kA_published,</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">37.094</span>, <span class="dv">36</span>, <span class="fl">2.983</span>, <span class="dv">70</span>, <span class="fl">2.765</span>, <span class="dv">104</span>, <span class="fl">2.676</span>,</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  <span class="dv">3</span>, <span class="fl">10.553</span>, <span class="dv">37</span>, <span class="fl">2.972</span>, <span class="dv">71</span>, <span class="fl">2.762</span>, <span class="dv">105</span>, <span class="fl">2.674</span>,</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  <span class="dv">4</span>, <span class="fl">7.042</span>, <span class="dv">38</span>, <span class="fl">2.961</span>, <span class="dv">72</span>, <span class="fl">2.758</span>, <span class="dv">106</span>, <span class="fl">2.672</span>,</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  <span class="dv">5</span>, <span class="fl">5.741</span>, <span class="dv">39</span>, <span class="fl">2.951</span>, <span class="dv">73</span>, <span class="fl">2.755</span>, <span class="dv">107</span>, <span class="fl">2.671</span>,</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="dv">6</span>, <span class="fl">5.062</span>, <span class="dv">40</span>, <span class="fl">2.941</span>, <span class="dv">74</span>, <span class="fl">2.751</span>, <span class="dv">108</span>, <span class="fl">2.669</span>,</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  <span class="dv">7</span>, <span class="fl">4.642</span>, <span class="dv">41</span>, <span class="fl">2.932</span>, <span class="dv">75</span>, <span class="fl">2.748</span>, <span class="dv">109</span>, <span class="fl">2.667</span>,</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  <span class="dv">8</span>, <span class="fl">4.354</span>, <span class="dv">42</span>, <span class="fl">2.923</span>, <span class="dv">76</span>, <span class="fl">2.745</span>, <span class="dv">110</span>, <span class="fl">2.665</span>,</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  <span class="dv">9</span>, <span class="fl">4.143</span>, <span class="dv">43</span>, <span class="fl">2.914</span>, <span class="dv">77</span>, <span class="fl">2.742</span>, <span class="dv">111</span>, <span class="fl">2.663</span>,</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="dv">10</span>, <span class="fl">3.981</span>, <span class="dv">44</span>, <span class="fl">2.906</span>, <span class="dv">78</span>, <span class="fl">2.739</span>, <span class="dv">112</span>, <span class="fl">2.662</span>,</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  <span class="dv">11</span>, <span class="fl">3.852</span>, <span class="dv">45</span>, <span class="fl">2.898</span>, <span class="dv">79</span>, <span class="fl">2.736</span>, <span class="dv">113</span>, <span class="fl">2.660</span>,</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  <span class="dv">12</span>, <span class="fl">3.747</span>, <span class="dv">46</span>, <span class="fl">2.890</span>, <span class="dv">80</span>, <span class="fl">2.733</span>, <span class="dv">114</span>, <span class="fl">2.658</span>,</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  <span class="dv">13</span>, <span class="fl">3.659</span>, <span class="dv">47</span>, <span class="fl">2.883</span>, <span class="dv">81</span>, <span class="fl">2.730</span>, <span class="dv">115</span>, <span class="fl">2.657</span>,</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  <span class="dv">14</span>, <span class="fl">3.585</span>, <span class="dv">48</span>, <span class="fl">2.876</span>, <span class="dv">82</span>, <span class="fl">2.727</span>, <span class="dv">116</span>, <span class="fl">2.655</span>,</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>  <span class="dv">15</span>, <span class="fl">3.520</span>, <span class="dv">49</span>, <span class="fl">2.869</span>, <span class="dv">83</span>, <span class="fl">2.724</span>, <span class="dv">117</span>, <span class="fl">2.654</span>,</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  <span class="dv">16</span>, <span class="fl">3.464</span>, <span class="dv">50</span>, <span class="fl">2.862</span>, <span class="dv">84</span>, <span class="fl">2.721</span>, <span class="dv">118</span>, <span class="fl">2.652</span>,</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  <span class="dv">17</span>, <span class="fl">3.414</span>, <span class="dv">51</span>, <span class="fl">2.856</span>, <span class="dv">85</span>, <span class="fl">2.719</span>, <span class="dv">119</span>, <span class="fl">2.651</span>,</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>  <span class="dv">18</span>, <span class="fl">3.370</span>, <span class="dv">52</span>, <span class="fl">2.850</span>, <span class="dv">86</span>, <span class="fl">2.716</span>, <span class="dv">120</span>, <span class="fl">2.649</span>,</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>  <span class="dv">19</span>, <span class="fl">3.331</span>, <span class="dv">53</span>, <span class="fl">2.844</span>, <span class="dv">87</span>, <span class="fl">2.714</span>, <span class="dv">121</span>, <span class="fl">2.648</span>,</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>  <span class="dv">20</span>, <span class="fl">3.295</span>, <span class="dv">54</span>, <span class="fl">2.838</span>, <span class="dv">88</span>, <span class="fl">2.711</span>, <span class="dv">122</span>, <span class="fl">2.646</span>,</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>  <span class="dv">21</span>, <span class="fl">3.263</span>, <span class="dv">55</span>, <span class="fl">2.833</span>, <span class="dv">89</span>, <span class="fl">2.709</span>, <span class="dv">123</span>, <span class="fl">2.645</span>,</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>  <span class="dv">22</span>, <span class="fl">3.233</span>, <span class="dv">56</span>, <span class="fl">2.827</span>, <span class="dv">90</span>, <span class="fl">2.706</span>, <span class="dv">124</span>, <span class="fl">2.643</span>,</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>  <span class="dv">23</span>, <span class="fl">3.206</span>, <span class="dv">57</span>, <span class="fl">2.822</span>, <span class="dv">91</span>, <span class="fl">2.704</span>, <span class="dv">125</span>, <span class="fl">2.642</span>,</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>  <span class="dv">24</span>, <span class="fl">3.181</span>, <span class="dv">58</span>, <span class="fl">2.817</span>, <span class="dv">92</span>, <span class="fl">2.701</span>, <span class="dv">126</span>, <span class="fl">2.640</span>,</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>  <span class="dv">25</span>, <span class="fl">3.158</span>, <span class="dv">59</span>, <span class="fl">2.812</span>, <span class="dv">93</span>, <span class="fl">2.699</span>, <span class="dv">127</span>, <span class="fl">2.639</span>,</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>  <span class="dv">26</span>, <span class="fl">3.136</span>, <span class="dv">60</span>, <span class="fl">2.807</span>, <span class="dv">94</span>, <span class="fl">2.697</span>, <span class="dv">128</span>, <span class="fl">2.638</span>,</span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>  <span class="dv">27</span>, <span class="fl">3.116</span>, <span class="dv">61</span>, <span class="fl">2.802</span>, <span class="dv">95</span>, <span class="fl">2.695</span>, <span class="dv">129</span>, <span class="fl">2.636</span>,</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>  <span class="dv">28</span>, <span class="fl">3.098</span>, <span class="dv">62</span>, <span class="fl">2.798</span>, <span class="dv">96</span>, <span class="fl">2.692</span>, <span class="dv">130</span>, <span class="fl">2.635</span>,</span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  <span class="dv">29</span>, <span class="fl">3.080</span>, <span class="dv">63</span>, <span class="fl">2.793</span>, <span class="dv">97</span>, <span class="fl">2.690</span>, <span class="dv">131</span>, <span class="fl">2.634</span>,</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>  <span class="dv">30</span>, <span class="fl">3.064</span>, <span class="dv">64</span>, <span class="fl">2.789</span>, <span class="dv">98</span>, <span class="fl">2.688</span>, <span class="dv">132</span>, <span class="fl">2.632</span>,</span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>  <span class="dv">31</span>, <span class="fl">3.048</span>, <span class="dv">65</span>, <span class="fl">2.785</span>, <span class="dv">99</span>, <span class="fl">2.686</span>, <span class="dv">133</span>, <span class="fl">2.631</span>,</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>  <span class="dv">32</span>, <span class="fl">3.034</span>, <span class="dv">66</span>, <span class="fl">2.781</span>, <span class="dv">100</span>, <span class="fl">2.684</span>, <span class="dv">134</span>, <span class="fl">2.630</span>,</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>  <span class="dv">33</span>, <span class="fl">3.020</span>, <span class="dv">67</span>, <span class="fl">2.777</span>, <span class="dv">101</span>, <span class="fl">2.682</span>, <span class="dv">135</span>, <span class="fl">2.628</span>,</span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a>  <span class="dv">34</span>, <span class="fl">3.007</span>, <span class="dv">68</span>, <span class="fl">2.773</span>, <span class="dv">102</span>, <span class="fl">2.680</span>, <span class="dv">136</span>, <span class="fl">2.627</span>,</span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a>  <span class="dv">35</span>, <span class="fl">2.995</span>, <span class="dv">69</span>, <span class="fl">2.769</span>, <span class="dv">103</span>, <span class="fl">2.678</span>, <span class="dv">137</span>, <span class="fl">2.626</span></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>  <span class="fu">arrange</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kA_cmstatr =</span> <span class="fu">k_factor_normal</span>(n, <span class="at">p =</span> <span class="fl">0.99</span>, <span class="at">conf =</span> <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">expect_equal</span>(kA_published, kA_cmstatr, <span class="at">tolerance =</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(diff))</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a><span class="co">#&gt; # A tibble: 136 × 3</span></span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a><span class="co">#&gt;        n kA_published kA_cmstatr</span></span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a><span class="co">#&gt;  1     2        37.1       37.1 </span></span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a><span class="co">#&gt;  2     3        10.6       10.6 </span></span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a><span class="co">#&gt;  3     4         7.04       7.04</span></span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a><span class="co">#&gt;  4     5         5.74       5.74</span></span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a><span class="co">#&gt;  5     6         5.06       5.06</span></span>
<span id="cb53-52"><a href="#cb53-52" tabindex="-1"></a><span class="co">#&gt;  6     7         4.64       4.64</span></span>
<span id="cb53-53"><a href="#cb53-53" tabindex="-1"></a><span class="co">#&gt;  7     8         4.35       4.35</span></span>
<span id="cb53-54"><a href="#cb53-54" tabindex="-1"></a><span class="co">#&gt;  8     9         4.14       4.14</span></span>
<span id="cb53-55"><a href="#cb53-55" tabindex="-1"></a><span class="co">#&gt;  9    10         3.98       3.98</span></span>
<span id="cb53-56"><a href="#cb53-56" tabindex="-1"></a><span class="co">#&gt; 10    11         3.85       3.85</span></span>
<span id="cb53-57"><a href="#cb53-57" tabindex="-1"></a><span class="co">#&gt; # ℹ 126 more rows</span></span></code></pre></div>
</div>
<div id="pf-hk" class="section level2">
<h2>7.3 Nonparametric B-Basis Extended Hanson–Koopmans</h2>
<p>Vangel <span class="citation">[5]</span> provides extensive tables of
<span class="math inline">\(z\)</span> for the case where <span class="math inline">\(i=1\)</span> and <span class="math inline">\(j\)</span> is the median observation. This section
checks the results of <code>cmstatr</code>’s function against those
tables. Only the odd values of <span class="math inline">\(n\)</span>
are checked so that the median is a single observation. The unit tests
for the <code>cmstatr</code> package include checks of a variety of
values of <span class="math inline">\(p\)</span> and confidence, but
only the factors for B-Basis are checked here.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>z,</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="dv">3</span>,  <span class="fl">28.820048</span>,</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  <span class="dv">5</span>,  <span class="fl">6.1981307</span>,</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  <span class="dv">7</span>,  <span class="fl">3.4780112</span>,</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  <span class="dv">9</span>,  <span class="fl">2.5168762</span>,</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  <span class="dv">11</span>, <span class="fl">2.0312134</span>,</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="dv">13</span>, <span class="fl">1.7377374</span>,</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  <span class="dv">15</span>, <span class="fl">1.5403989</span>,</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>  <span class="dv">17</span>, <span class="fl">1.3979806</span>,</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  <span class="dv">19</span>, <span class="fl">1.2899172</span>,</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  <span class="dv">21</span>, <span class="fl">1.2048089</span>,</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  <span class="dv">23</span>, <span class="fl">1.1358259</span>,</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>  <span class="dv">25</span>, <span class="fl">1.0786237</span>,</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  <span class="dv">27</span>, <span class="fl">1.0303046</span>,</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>    <span class="at">z_calc =</span> <span class="fu">hk_ext_z</span>(n, <span class="dv">1</span>, <span class="fu">ceiling</span>(n <span class="sc">/</span> <span class="dv">2</span>), <span class="at">p =</span> <span class="fl">0.90</span>, <span class="at">conf =</span> <span class="fl">0.95</span>)</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">expect_equal</span>(z, z_calc, <span class="at">tolerance =</span> <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(diff))</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a><span class="co">#&gt; # A tibble: 13 × 3</span></span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a><span class="co">#&gt;        n     z z_calc</span></span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a><span class="co">#&gt;  1     3 28.8   28.8 </span></span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a><span class="co">#&gt;  2     5  6.20   6.20</span></span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a><span class="co">#&gt;  3     7  3.48   3.48</span></span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a><span class="co">#&gt;  4     9  2.52   2.52</span></span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a><span class="co">#&gt;  5    11  2.03   2.03</span></span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a><span class="co">#&gt;  6    13  1.74   1.74</span></span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a><span class="co">#&gt;  7    15  1.54   1.54</span></span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a><span class="co">#&gt;  8    17  1.40   1.40</span></span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a><span class="co">#&gt;  9    19  1.29   1.29</span></span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a><span class="co">#&gt; 10    21  1.20   1.20</span></span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a><span class="co">#&gt; 11    23  1.14   1.14</span></span>
<span id="cb54-38"><a href="#cb54-38" tabindex="-1"></a><span class="co">#&gt; 12    25  1.08   1.08</span></span>
<span id="cb54-39"><a href="#cb54-39" tabindex="-1"></a><span class="co">#&gt; 13    27  1.03   1.03</span></span></code></pre></div>
</div>
<div id="pf-hk2" class="section level2">
<h2>7.4 Nonparametric A-Basis Extended Hanson–Koopmans</h2>
<p>CMH-17-1G provides Table 8.5.15, which contains factors for
calculating A-Basis values using the Extended Hanson–Koopmans
nonparametric method. That table is reproduced in part here and the
factors are compared with those computed by <code>cmstatr</code>. More
extensive checks are performed in the unit test of the
<code>cmstatr</code> package. The factors computed by
<code>cmstatr</code> are very similar to those published in
CMH-17-1G.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>k,</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="dv">2</span>, <span class="fl">80.0038</span>,</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="dv">4</span>, <span class="fl">9.49579</span>,</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="dv">6</span>, <span class="fl">5.57681</span>,</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="dv">8</span>, <span class="fl">4.25011</span>,</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  <span class="dv">10</span>, <span class="fl">3.57267</span>,</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="dv">12</span>, <span class="fl">3.1554</span>,</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="dv">14</span>, <span class="fl">2.86924</span>,</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>  <span class="dv">16</span>, <span class="fl">2.65889</span>,</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  <span class="dv">18</span>, <span class="fl">2.4966</span>,</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  <span class="dv">20</span>, <span class="fl">2.36683</span>,</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  <span class="dv">25</span>, <span class="fl">2.131</span>,</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  <span class="dv">30</span>, <span class="fl">1.96975</span>,</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  <span class="dv">35</span>, <span class="fl">1.85088</span>,</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="dv">40</span>, <span class="fl">1.75868</span>,</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  <span class="dv">45</span>, <span class="fl">1.68449</span>,</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  <span class="dv">50</span>, <span class="fl">1.62313</span>,</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  <span class="dv">60</span>, <span class="fl">1.5267</span>,</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  <span class="dv">70</span>, <span class="fl">1.45352</span>,</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  <span class="dv">80</span>, <span class="fl">1.39549</span>,</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  <span class="dv">90</span>, <span class="fl">1.34796</span>,</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  <span class="dv">100</span>, <span class="fl">1.30806</span>,</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  <span class="dv">120</span>, <span class="fl">1.24425</span>,</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  <span class="dv">140</span>, <span class="fl">1.19491</span>,</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  <span class="dv">160</span>, <span class="fl">1.15519</span>,</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  <span class="dv">180</span>, <span class="fl">1.12226</span>,</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  <span class="dv">200</span>, <span class="fl">1.09434</span>,</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>  <span class="dv">225</span>, <span class="fl">1.06471</span>,</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  <span class="dv">250</span>, <span class="fl">1.03952</span>,</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  <span class="dv">275</span>, <span class="fl">1.01773</span></span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_calc =</span> <span class="fu">hk_ext_z</span>(n, <span class="dv">1</span>, n, <span class="fl">0.99</span>, <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">expect_lt</span>(<span class="fu">abs</span>(k <span class="sc">-</span> z_calc), <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(diff))</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a><span class="co">#&gt; # A tibble: 29 × 3</span></span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a><span class="co">#&gt;        n     k z_calc</span></span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a><span class="co">#&gt;  1     2 80.0   80.0 </span></span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a><span class="co">#&gt;  2     4  9.50   9.50</span></span>
<span id="cb55-43"><a href="#cb55-43" tabindex="-1"></a><span class="co">#&gt;  3     6  5.58   5.58</span></span>
<span id="cb55-44"><a href="#cb55-44" tabindex="-1"></a><span class="co">#&gt;  4     8  4.25   4.25</span></span>
<span id="cb55-45"><a href="#cb55-45" tabindex="-1"></a><span class="co">#&gt;  5    10  3.57   3.57</span></span>
<span id="cb55-46"><a href="#cb55-46" tabindex="-1"></a><span class="co">#&gt;  6    12  3.16   3.16</span></span>
<span id="cb55-47"><a href="#cb55-47" tabindex="-1"></a><span class="co">#&gt;  7    14  2.87   2.87</span></span>
<span id="cb55-48"><a href="#cb55-48" tabindex="-1"></a><span class="co">#&gt;  8    16  2.66   2.66</span></span>
<span id="cb55-49"><a href="#cb55-49" tabindex="-1"></a><span class="co">#&gt;  9    18  2.50   2.50</span></span>
<span id="cb55-50"><a href="#cb55-50" tabindex="-1"></a><span class="co">#&gt; 10    20  2.37   2.37</span></span>
<span id="cb55-51"><a href="#cb55-51" tabindex="-1"></a><span class="co">#&gt; # ℹ 19 more rows</span></span></code></pre></div>
</div>
<div id="pf-hk-opt" class="section level2">
<h2>7.5 Factors for Small Sample Nonparametric B-Basis</h2>
<p>CMH-17-1G Table 8.5.14 provides ranks orders and factors for
computing nonparametric B-Basis values. This table is reproduced below
and compared with the results of <code>cmstatr</code>. The results are
similar. In some cases, the rank order (<span class="math inline">\(r\)</span> in CMH-17-1G or <span class="math inline">\(j\)</span> in <code>cmstatr</code>) <em>and</em>
the the factor (<span class="math inline">\(k\)</span>) are different.
These differences are discussed in detail in the vignette <a href="hk_ext.html">Extended Hanson-Koopmans</a>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>r, <span class="sc">~</span>k,</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">35.177</span>,</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  <span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">7.859</span>,</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">4.505</span>,</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">4.101</span>,</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  <span class="dv">6</span>, <span class="dv">5</span>, <span class="fl">3.064</span>,</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  <span class="dv">7</span>, <span class="dv">5</span>, <span class="fl">2.858</span>,</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  <span class="dv">8</span>, <span class="dv">6</span>, <span class="fl">2.382</span>,</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  <span class="dv">9</span>, <span class="dv">6</span>, <span class="fl">2.253</span>,</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  <span class="dv">10</span>, <span class="dv">6</span>, <span class="fl">2.137</span>,</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  <span class="dv">11</span>, <span class="dv">7</span>, <span class="fl">1.897</span>,</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  <span class="dv">12</span>, <span class="dv">7</span>, <span class="fl">1.814</span>,</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  <span class="dv">13</span>, <span class="dv">7</span>, <span class="fl">1.738</span>,</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  <span class="dv">14</span>, <span class="dv">8</span>, <span class="fl">1.599</span>,</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  <span class="dv">15</span>, <span class="dv">8</span>, <span class="fl">1.540</span>,</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  <span class="dv">16</span>, <span class="dv">8</span>, <span class="fl">1.485</span>,</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  <span class="dv">17</span>, <span class="dv">8</span>, <span class="fl">1.434</span>,</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  <span class="dv">18</span>, <span class="dv">9</span>, <span class="fl">1.354</span>,</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>  <span class="dv">19</span>, <span class="dv">9</span>, <span class="fl">1.311</span>,</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  <span class="dv">20</span>, <span class="dv">10</span>, <span class="fl">1.253</span>,</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  <span class="dv">21</span>, <span class="dv">10</span>, <span class="fl">1.218</span>,</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>  <span class="dv">22</span>, <span class="dv">10</span>, <span class="fl">1.184</span>,</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>  <span class="dv">23</span>, <span class="dv">11</span>, <span class="fl">1.143</span>,</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>  <span class="dv">24</span>, <span class="dv">11</span>, <span class="fl">1.114</span>,</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>  <span class="dv">25</span>, <span class="dv">11</span>, <span class="fl">1.087</span>,</span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a>  <span class="dv">26</span>, <span class="dv">11</span>, <span class="fl">1.060</span>,</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>  <span class="dv">27</span>, <span class="dv">11</span>, <span class="fl">1.035</span>,</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>  <span class="dv">28</span>, <span class="dv">12</span>, <span class="fl">1.010</span></span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_calc =</span> <span class="fu">hk_ext_z_j_opt</span>(n, <span class="fl">0.90</span>, <span class="fl">0.95</span>)<span class="sc">$</span>j) <span class="sc">%&gt;%</span></span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k_calc =</span> <span class="fu">hk_ext_z_j_opt</span>(n, <span class="fl">0.90</span>, <span class="fl">0.95</span>)<span class="sc">$</span>z)</span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a><span class="co">#&gt; # A tibble: 27 × 5</span></span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb56-36"><a href="#cb56-36" tabindex="-1"></a><span class="co">#&gt;        n     r     k r_calc k_calc</span></span>
<span id="cb56-37"><a href="#cb56-37" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;  &lt;dbl&gt;</span></span>
<span id="cb56-38"><a href="#cb56-38" tabindex="-1"></a><span class="co">#&gt;  1     2     2 35.2       2  35.2 </span></span>
<span id="cb56-39"><a href="#cb56-39" tabindex="-1"></a><span class="co">#&gt;  2     3     3  7.86      3   7.86</span></span>
<span id="cb56-40"><a href="#cb56-40" tabindex="-1"></a><span class="co">#&gt;  3     4     4  4.50      4   4.51</span></span>
<span id="cb56-41"><a href="#cb56-41" tabindex="-1"></a><span class="co">#&gt;  4     5     4  4.10      4   4.10</span></span>
<span id="cb56-42"><a href="#cb56-42" tabindex="-1"></a><span class="co">#&gt;  5     6     5  3.06      5   3.06</span></span>
<span id="cb56-43"><a href="#cb56-43" tabindex="-1"></a><span class="co">#&gt;  6     7     5  2.86      5   2.86</span></span>
<span id="cb56-44"><a href="#cb56-44" tabindex="-1"></a><span class="co">#&gt;  7     8     6  2.38      6   2.38</span></span>
<span id="cb56-45"><a href="#cb56-45" tabindex="-1"></a><span class="co">#&gt;  8     9     6  2.25      6   2.25</span></span>
<span id="cb56-46"><a href="#cb56-46" tabindex="-1"></a><span class="co">#&gt;  9    10     6  2.14      6   2.14</span></span>
<span id="cb56-47"><a href="#cb56-47" tabindex="-1"></a><span class="co">#&gt; 10    11     7  1.90      7   1.90</span></span>
<span id="cb56-48"><a href="#cb56-48" tabindex="-1"></a><span class="co">#&gt; # ℹ 17 more rows</span></span></code></pre></div>
</div>
<div id="pf-npbinom" class="section level2">
<h2>7.6 Nonparametric B-Basis Binomial Rank</h2>
<p>CMH-17-1G Table 8.5.12 provides factors for computing B-Basis values
using the nonparametric binomial rank method. Part of that table is
reproduced below and compared with the results of <code>cmstatr</code>.
The results of <code>cmstatr</code> are similar to the published values.
A more complete comparison is performed in the units tests of the
<code>cmstatr</code> package.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>rb,</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>  <span class="dv">29</span>, <span class="dv">1</span>,</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  <span class="dv">46</span>, <span class="dv">2</span>,</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  <span class="dv">61</span>, <span class="dv">3</span>,</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  <span class="dv">76</span>, <span class="dv">4</span>,</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>  <span class="dv">89</span>, <span class="dv">5</span>,</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>  <span class="dv">103</span>, <span class="dv">6</span>,</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  <span class="dv">116</span>, <span class="dv">7</span>,</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  <span class="dv">129</span>, <span class="dv">8</span>,</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  <span class="dv">142</span>, <span class="dv">9</span>,</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>  <span class="dv">154</span>, <span class="dv">10</span>,</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>  <span class="dv">167</span>, <span class="dv">11</span>,</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>  <span class="dv">179</span>, <span class="dv">12</span>,</span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>  <span class="dv">191</span>, <span class="dv">13</span>,</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>  <span class="dv">203</span>, <span class="dv">14</span></span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_calc =</span> <span class="fu">nonpara_binomial_rank</span>(n, <span class="fl">0.9</span>, <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">test =</span> <span class="fu">expect_equal</span>(rb, r_calc)) <span class="sc">%&gt;%</span></span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(test))</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a><span class="co">#&gt; # A tibble: 14 × 3</span></span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a><span class="co">#&gt;        n    rb r_calc</span></span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a><span class="co">#&gt;  1    29     1      1</span></span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a><span class="co">#&gt;  2    46     2      2</span></span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a><span class="co">#&gt;  3    61     3      3</span></span>
<span id="cb57-29"><a href="#cb57-29" tabindex="-1"></a><span class="co">#&gt;  4    76     4      4</span></span>
<span id="cb57-30"><a href="#cb57-30" tabindex="-1"></a><span class="co">#&gt;  5    89     5      5</span></span>
<span id="cb57-31"><a href="#cb57-31" tabindex="-1"></a><span class="co">#&gt;  6   103     6      6</span></span>
<span id="cb57-32"><a href="#cb57-32" tabindex="-1"></a><span class="co">#&gt;  7   116     7      7</span></span>
<span id="cb57-33"><a href="#cb57-33" tabindex="-1"></a><span class="co">#&gt;  8   129     8      8</span></span>
<span id="cb57-34"><a href="#cb57-34" tabindex="-1"></a><span class="co">#&gt;  9   142     9      9</span></span>
<span id="cb57-35"><a href="#cb57-35" tabindex="-1"></a><span class="co">#&gt; 10   154    10     10</span></span>
<span id="cb57-36"><a href="#cb57-36" tabindex="-1"></a><span class="co">#&gt; 11   167    11     11</span></span>
<span id="cb57-37"><a href="#cb57-37" tabindex="-1"></a><span class="co">#&gt; 12   179    12     12</span></span>
<span id="cb57-38"><a href="#cb57-38" tabindex="-1"></a><span class="co">#&gt; 13   191    13     13</span></span>
<span id="cb57-39"><a href="#cb57-39" tabindex="-1"></a><span class="co">#&gt; 14   203    14     14</span></span></code></pre></div>
</div>
<div id="pf-npbinom2" class="section level2">
<h2>7.7 Nonparametric A-Basis Binomial Rank</h2>
<p>CMH-17-1G Table 8.5.13 provides factors for computing B-Basis values
using the nonparametric binomial rank method. Part of that table is
reproduced below and compared with the results of <code>cmstatr</code>.
The results of <code>cmstatr</code> are similar to the published values.
A more complete comparison is performed in the units tests of the
<code>cmstatr</code> package.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  <span class="sc">~</span>n, <span class="sc">~</span>ra,</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="dv">299</span>, <span class="dv">1</span>,</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  <span class="dv">473</span>, <span class="dv">2</span>,</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="dv">628</span>, <span class="dv">3</span>,</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  <span class="dv">773</span>, <span class="dv">4</span>,</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  <span class="dv">913</span>, <span class="dv">5</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_calc =</span> <span class="fu">nonpara_binomial_rank</span>(n, <span class="fl">0.99</span>, <span class="fl">0.95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">test =</span> <span class="fu">expect_equal</span>(ra, r_calc)) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(test))</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 3</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="co">#&gt; # Rowwise: </span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="co">#&gt;       n    ra r_calc</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a><span class="co">#&gt; 1   299     1      1</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a><span class="co">#&gt; 2   473     2      2</span></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a><span class="co">#&gt; 3   628     3      3</span></span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a><span class="co">#&gt; 4   773     4      4</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a><span class="co">#&gt; 5   913     5      5</span></span></code></pre></div>
</div>
<div id="pf-equiv" class="section level2">
<h2>7.8 Factors for Equivalency</h2>
<p>Vangel’s 2002 paper provides factors for calculating limits for
sample mean and sample extremum for various values of <span class="math inline">\(\alpha\)</span> and sample size (<span class="math inline">\(n\)</span>). A subset of those factors are
reproduced below and compared with results from <code>cmstatr</code>.
The results are very similar for values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(n\)</span> that are common for composite
materials.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;k1.vangel.csv&quot;</span>,</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>                     <span class="at">package =</span> <span class="st">&quot;cmstatr&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="fu">gather</span>(n, k1, X2<span class="sc">:</span>X10) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">as.numeric</span>(<span class="fu">substring</span>(n, <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>    <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;k2.vangel.csv&quot;</span>,</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>                         <span class="at">package =</span> <span class="st">&quot;cmstatr&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>      <span class="fu">gather</span>(n, k2, X2<span class="sc">:</span>X10) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">as.numeric</span>(<span class="fu">substring</span>(n, <span class="dv">2</span>))),</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span> <span class="ot">=</span> <span class="st">&quot;n&quot;</span>, <span class="st">&quot;alpha&quot;</span> <span class="ot">=</span> <span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> (alpha <span class="sc">==</span> <span class="fl">0.01</span> <span class="sc">|</span> alpha <span class="sc">==</span> <span class="fl">0.05</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  <span class="fu">group_by</span>(n, alpha) <span class="sc">%&gt;%</span></span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">equiv =</span> <span class="fu">map2</span>(alpha, n, <span class="sc">~</span><span class="fu">k_equiv</span>(.x, .y))) <span class="sc">%&gt;%</span></span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k1_calc =</span> <span class="fu">map</span>(equiv, <span class="cf">function</span>(e) e[<span class="dv">1</span>]),</span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>         <span class="at">k2_calc =</span> <span class="fu">map</span>(equiv, <span class="cf">function</span>(e) e[<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(equiv)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(data, k1_calc, k2_calc)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check =</span> <span class="fu">expect_equal</span>(k1, k1_calc, <span class="at">tolerance =</span> <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(check)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">check =</span> <span class="fu">expect_equal</span>(k2, k2_calc, <span class="at">tolerance =</span> <span class="fl">0.0001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(check))</span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a><span class="co">#&gt; # A tibble: 12 × 6</span></span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a><span class="co">#&gt; # Groups:   n, alpha [12]</span></span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a><span class="co">#&gt;    alpha     n    k1    k2 k1_calc k2_calc</span></span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a><span class="co">#&gt;  1  0.05     5  2.53 0.852    2.53   0.853</span></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a><span class="co">#&gt;  2  0.01     5  3.07 1.14     3.07   1.14 </span></span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a><span class="co">#&gt;  3  0.05     6  2.60 0.781    2.60   0.781</span></span>
<span id="cb59-31"><a href="#cb59-31" tabindex="-1"></a><span class="co">#&gt;  4  0.01     6  3.13 1.04     3.13   1.04 </span></span>
<span id="cb59-32"><a href="#cb59-32" tabindex="-1"></a><span class="co">#&gt;  5  0.05     7  2.65 0.725    2.65   0.725</span></span>
<span id="cb59-33"><a href="#cb59-33" tabindex="-1"></a><span class="co">#&gt;  6  0.01     7  3.18 0.968    3.18   0.968</span></span>
<span id="cb59-34"><a href="#cb59-34" tabindex="-1"></a><span class="co">#&gt;  7  0.05     8  2.7  0.679    2.70   0.679</span></span>
<span id="cb59-35"><a href="#cb59-35" tabindex="-1"></a><span class="co">#&gt;  8  0.01     8  3.22 0.906    3.22   0.906</span></span>
<span id="cb59-36"><a href="#cb59-36" tabindex="-1"></a><span class="co">#&gt;  9  0.05     9  2.74 0.641    2.74   0.641</span></span>
<span id="cb59-37"><a href="#cb59-37" tabindex="-1"></a><span class="co">#&gt; 10  0.01     9  3.25 0.854    3.25   0.855</span></span>
<span id="cb59-38"><a href="#cb59-38" tabindex="-1"></a><span class="co">#&gt; 11  0.05    10  2.78 0.609    2.78   0.609</span></span>
<span id="cb59-39"><a href="#cb59-39" tabindex="-1"></a><span class="co">#&gt; 12  0.01    10  3.28 0.811    3.28   0.811</span></span></code></pre></div>
</div>
</div>
<div id="session-info" class="section level1">
<h1>8. Session Info</h1>
<p>This copy of this vignette was build on the following system.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="co">#&gt; Running under: Ubuntu 20.04.6 LTS</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 </span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a><span class="co">#&gt;  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C              </span></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a><span class="co">#&gt;  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=C              </span></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a><span class="co">#&gt;  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   </span></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a><span class="co">#&gt;  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 </span></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a><span class="co">#&gt; [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a><span class="co">#&gt; time zone: America/Edmonton</span></span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a><span class="co">#&gt; [1] testthat_3.2.1 purrr_1.0.2    cmstatr_0.9.3  tidyr_1.3.1    ggplot2_3.5.0 </span></span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a><span class="co">#&gt; [6] dplyr_1.1.4   </span></span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a><span class="co">#&gt;  [1] gtable_0.3.4      jsonlite_1.8.8    highr_0.10        crayon_1.5.2     </span></span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a><span class="co">#&gt;  [5] compiler_4.3.3    brio_1.1.4        tidyselect_1.2.0  jquerylib_0.1.4  </span></span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a><span class="co">#&gt;  [9] scales_1.3.0      yaml_2.3.8        fastmap_1.1.1     R6_2.5.1         </span></span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a><span class="co">#&gt; [13] labeling_0.4.3    kSamples_1.2-10   generics_0.1.3    knitr_1.45       </span></span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a><span class="co">#&gt; [17] MASS_7.3-60       tibble_3.2.1      desc_1.4.3        rprojroot_2.0.4  </span></span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a><span class="co">#&gt; [21] munsell_0.5.0     bslib_0.6.1       pillar_1.9.0      SuppDists_1.1-9.7</span></span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a><span class="co">#&gt; [25] rlang_1.1.3       utf8_1.2.4        cachem_1.0.8      xfun_0.42        </span></span>
<span id="cb60-36"><a href="#cb60-36" tabindex="-1"></a><span class="co">#&gt; [29] sass_0.4.8        pkgload_1.3.4     viridisLite_0.4.2 cli_3.6.2        </span></span>
<span id="cb60-37"><a href="#cb60-37" tabindex="-1"></a><span class="co">#&gt; [33] withr_3.0.0       magrittr_2.0.3    digest_0.6.34     grid_4.3.3       </span></span>
<span id="cb60-38"><a href="#cb60-38" tabindex="-1"></a><span class="co">#&gt; [37] rstudioapi_0.15.0 lifecycle_1.0.4   waldo_0.5.2       vctrs_0.6.5      </span></span>
<span id="cb60-39"><a href="#cb60-39" tabindex="-1"></a><span class="co">#&gt; [41] evaluate_0.23     glue_1.7.0        farver_2.1.1      fansi_1.0.6      </span></span>
<span id="cb60-40"><a href="#cb60-40" tabindex="-1"></a><span class="co">#&gt; [45] colorspace_2.1-0  rmarkdown_2.26    tools_4.3.3       pkgconfig_2.0.3  </span></span>
<span id="cb60-41"><a href="#cb60-41" tabindex="-1"></a><span class="co">#&gt; [49] htmltools_0.5.7</span></span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">9. References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-ASAP2008" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">K.
S. Raju and J. S. Tomblin, <span>“AGATE Statistical Analysis
Program,”</span> Wichita State University, ASAP-2008, 2008.</div>
</div>
<div id="ref-CMH-17-1G" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline"><span>“Composite Materials Handbook, Volume 1.
Polymer Matrix Composites Guideline for Characterization of Structural
Materials,”</span> SAE International, CMH-17-1G, Mar. 2012.</div>
</div>
<div id="ref-STAT-17" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">Materials Sciences Corporation, <span>“CMH-17
Statistical Analysis for B-Basis and A-Basis Values,”</span> Materials
Sciences Corporation, Horsham, PA, STAT-17 Rev 5, Jan. 2008.</div>
</div>
<div id="ref-Stephens1987" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">F.
W. Scholz and M. A. Stephens, <span>“<a href="https://doi.org/10.1080/01621459.1987.10478517">K-Sample
Anderson-Darling Tests</a>,”</span> <em>Journal of the American
Statistical Association</em>, vol. 82, no. 399. pp. 918–924,
Sep-1987.</div>
</div>
<div id="ref-Vangel1994" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">M.
Vangel, <span>“<a href="https://doi.org/10.1080/03610919408813222">One-Sided Nonparametric
Tolerance Limits</a>,”</span> <em>Communications in Statistics -
Simulation and Computation</em>, vol. 23, no. 4. pp. 1137–1154,
1994.</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
